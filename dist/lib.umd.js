!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("web3"),require("bignumber.js"),require("cross-fetch"),require("@oceanprotocol/contracts/addresses/address.json"),require("crypto-js/sha256"),require("decimal.js"),require("@oceanprotocol/contracts/artifacts/contracts/pools/balancer/BPool.sol/BPool.json"),require("@oceanprotocol/contracts/artifacts/contracts/templates/ERC20Template.sol/ERC20Template.json"),require("@oceanprotocol/contracts/artifacts/contracts/pools/dispenser/Dispenser.sol/Dispenser.json"),require("@oceanprotocol/contracts/artifacts/contracts/pools/fixedRate/FixedRateExchange.sol/FixedRateExchange.json"),require("@oceanprotocol/contracts/artifacts/contracts/templates/ERC20TemplateEnterprise.sol/ERC20TemplateEnterprise.json"),require("@oceanprotocol/contracts/artifacts/contracts/templates/ERC721Template.sol/ERC721Template.json"),require("@oceanprotocol/contracts/artifacts/contracts/ERC721Factory.sol/ERC721Factory.json")):"function"==typeof define&&define.amd?define(["exports","web3","bignumber.js","cross-fetch","@oceanprotocol/contracts/addresses/address.json","crypto-js/sha256","decimal.js","@oceanprotocol/contracts/artifacts/contracts/pools/balancer/BPool.sol/BPool.json","@oceanprotocol/contracts/artifacts/contracts/templates/ERC20Template.sol/ERC20Template.json","@oceanprotocol/contracts/artifacts/contracts/pools/dispenser/Dispenser.sol/Dispenser.json","@oceanprotocol/contracts/artifacts/contracts/pools/fixedRate/FixedRateExchange.sol/FixedRateExchange.json","@oceanprotocol/contracts/artifacts/contracts/templates/ERC20TemplateEnterprise.sol/ERC20TemplateEnterprise.json","@oceanprotocol/contracts/artifacts/contracts/templates/ERC721Template.sol/ERC721Template.json","@oceanprotocol/contracts/artifacts/contracts/ERC721Factory.sol/ERC721Factory.json"],t):t((e||self).lib={},e.web3,e.BigNumber,e.crossFetch,e.DefaultContractsAddresses,e.sha256,e.Decimal,e.PoolTemplate,e.defaultErc20Abi,e.defaultDispenserAbi,e.defaultFixedRateExchangeAbi,e.defaultDatatokensEnterpriseAbi,e.defaultNftAbi,e.defaultFactory721Abi)}(this,function(e,t,r,n,o,i,s,a,c,u,l,f,h,m){function v(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var d,P=/*#__PURE__*/v(t),g=/*#__PURE__*/v(r),p=/*#__PURE__*/v(n),w=/*#__PURE__*/v(o),b=/*#__PURE__*/v(i),y=/*#__PURE__*/v(s),A=/*#__PURE__*/v(a),T=/*#__PURE__*/v(c),E=/*#__PURE__*/v(u),C=/*#__PURE__*/v(l),k=/*#__PURE__*/v(f),F=/*#__PURE__*/v(h),R=/*#__PURE__*/v(m);e.LogLevel=void 0,(d=e.LogLevel||(e.LogLevel={}))[d.None=-1]="None",d[d.Error=0]="Error",d[d.Warn=1]="Warn",d[d.Log=2]="Log",d[d.Verbose=3]="Verbose";var j=/*#__PURE__*/function(){function t(t){void 0===t&&(t=e.LogLevel.Error),this.logLevel=void 0,this.logLevel=t}var r=t.prototype;return r.setLevel=function(e){this.logLevel=e},r.bypass=function(){this.dispatch.apply(this,["log",-Infinity].concat([].slice.call(arguments)))},r.debug=function(){this.dispatch.apply(this,["debug",e.LogLevel.Verbose].concat([].slice.call(arguments)))},r.log=function(){this.dispatch.apply(this,["log",e.LogLevel.Log].concat([].slice.call(arguments)))},r.warn=function(){this.dispatch.apply(this,["warn",e.LogLevel.Warn].concat([].slice.call(arguments)))},r.error=function(){this.dispatch.apply(this,["error",e.LogLevel.Error].concat([].slice.call(arguments)))},r.dispatch=function(e,t){var r;this.logLevel>=t&&(r=console)[e].apply(r,[].slice.call(arguments,2))},t}(),I=new j,S={nouns:["Crab","Fish","Seal","Octopus","Shark","Seahorse","Walrus","Starfish","Whale","Orca","Penguin","Jellyfish","Squid","Lobster","Pelican","Shrimp","Oyster","Clam","Seagull","Dolphin","Shell","Cormorant","Otter","Anemone","Turtle","Coral","Ray","Barracuda","Krill","Anchovy","Angelfish","Barnacle","Clownfish","Cod","Cuttlefish","Eel","Fugu","Herring","Haddock","Ling","Mackerel","Manatee","Narwhal","Nautilus","Plankton","Porpoise","Prawn","Pufferfish","Swordfish","Tuna"],adjectives:["adamant","adroit","amatory","ambitious","amused","animistic","antic","arcadian","artistic","astonishing","astounding","baleful","bellicose","bilious","blissful","boorish","brave","breathtaking","brilliant","calamitous","caustic","cerulean","clever","charming","comely","competent","concomitant","confident","contumacious","corpulent","crapulous","creative","dazzling","dedicated","defamatory","delighted","delightful","determined","didactic","dilatory","dowdy","efficacious","effulgent","egregious","empowered","endemic","enthusiastic","equanimous","exceptional","execrable","fabulous","fantastic","fastidious","feckless","fecund","friable","fulsome","garrulous","generous","gentle","guileless","gustatory","heuristic","histrionic","hubristic","incendiary","incredible","insidious","insolent","inspired","intransigent","inveterate","invidious","invigorated","irksome","jejune","juicy","jocular","joyful","judicious","kind","lachrymose","limpid","loquacious","lovely","luminous","mannered","marvelous","mendacious","meretricious","minatory","mordant","motivated","munificent","nefarious","noxious","obtuse","optimistic","parsimonious","pendulous","pernicious","pervasive","petulant","passionate","phenomenal","platitudinous","pleasant","powerful","precipitate","propitious","puckish","querulous","quiescent","rebarbative","recalcitant","redolent","rhadamanthine","risible","ruminative","sagacious","salubrious","sartorial","sclerotic","serpentine","smart","spasmodic","strident","stunning","stupendous","taciturn","tactful","tasty","tenacious","tremendous","tremulous","trenchant","turbulent","turgid","ubiquitous","uxorious","verdant","vibrant","voluble","voracious","wheedling","withering","wonderful","zealous"]};function M(e){var t=e||S,r=Math.floor(Math.random()*t.adjectives.length),n=Math.floor(Math.random()*t.nouns.length),o=Math.floor(100*Math.random()),i=t.adjectives[r].replace(/^\w/,function(e){return e.toUpperCase()}),s=t.nouns[n].replace(/^\w/,function(e){return e.toUpperCase()});return{name:i+" "+s+" Token",symbol:(i.substring(0,3)+s.substring(0,3)).toUpperCase()+"-"+o}}var G=[{constant:!0,inputs:[],name:"name",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"_spender",type:"address"},{name:"_value",type:"uint256"}],name:"approve",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"totalSupply",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_value",type:"uint256"}],name:"transferFrom",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"decimals",outputs:[{name:"",type:"uint8"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"_owner",type:"address"}],name:"balanceOf",outputs:[{name:"balance",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"symbol",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"_to",type:"address"},{name:"_value",type:"uint256"}],name:"transfer",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"_owner",type:"address"},{name:"_spender",type:"address"}],name:"allowance",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{payable:!0,stateMutability:"payable",type:"fallback"},{anonymous:!1,inputs:[{indexed:!0,name:"owner",type:"address"},{indexed:!0,name:"spender",type:"address"},{indexed:!1,name:"value",type:"uint256"}],name:"Approval",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"from",type:"address"},{indexed:!0,name:"to",type:"address"},{indexed:!1,name:"value",type:"uint256"}],name:"Transfer",type:"event"}];function x(e,t){try{var r=e()}catch(e){return t(e)}return r&&r.then?r.then(void 0,t):r}var L=function(e,t,r){try{return Promise.resolve(x(function(){var n=new e.eth.Contract(G,t);return Promise.resolve(n.methods.decimals().call()).then(function(e){return"0"===e&&(e=18),g.default.config({EXPONENTIAL_AT:50}),new g.default(r).times(new g.default(10).exponentiatedBy(e)).toString()})},function(e){I.error("ERROR: FAILED TO CALL DECIMALS(), USING 18', "+e.message)}))}catch(e){return Promise.reject(e)}},O=function(e,t,r){try{return Promise.resolve(x(function(){var n=new e.eth.Contract(G,t);return Promise.resolve(n.methods.decimals().call()).then(function(e){"0"===e&&(e=18);var t=new g.default(r).div(new g.default(10).exponentiatedBy(e));return g.default.config({EXPONENTIAL_AT:50}),t.toString()})},function(e){I.error("ERROR: FAILED TO CALL DECIMALS(), USING 18' : "+e.message)}))}catch(e){return Promise.reject(e)}},U=function(e,t){try{var r=[t.ssContract,t.baseTokenAddress,t.baseTokenSender,t.publisherAddress,t.marketFeeCollector,t.poolTemplateAddress],n=t.vestedBlocks,o=P.default.utils.toWei(t.vestingAmount),i=t.baseTokenDecimals,s=P.default.utils.toWei(t.rate);return Promise.resolve(L(e,t.baseTokenAddress,t.initialBaseTokenLiquidity)).then(function(e){return{addresses:r,ssParams:[s,i,o,n,e],swapFees:[P.default.utils.toWei(t.swapFeeLiquidityProvider),P.default.utils.toWei(t.swapFeeMarketRunner)]}})}catch(e){return Promise.reject(e)}},D=function(e,t){try{return Promise.resolve(e.eth.getGasPrice()).then(function(e){var r=new g.default(e);return console.log("getFairGasPrice ",null==t?void 0:t.gasFeeMultiplier),t&&t.gasFeeMultiplier?r.multipliedBy(t.gasFeeMultiplier).integerValue(g.default.ROUND_DOWN).toString(10):r.toString(10)})}catch(e){return Promise.reject(e)}};function N(e,t){return t&&(t.transactionBlockTimeout&&(e.transactionBlockTimeout=t.transactionBlockTimeout),t.transactionConfirmationBlocks&&(e.transactionConfirmationBlocks=t.transactionConfirmationBlocks),t.transactionPollingTimeout&&(e.transactionPollingTimeout=t.transactionPollingTimeout)),console.log("contract config ",t.transactionBlockTimeout,t.transactionConfirmationBlocks,t.transactionPollingTimeout),console.log("contract value ",e.transactionBlockTimeout,e.transactionConfirmationBlocks,e.transactionPollingTimeout),e}function W(e){var t,r;if(!e.name||!e.symbol){var n=M();t=n.name,r=n.symbol}return{templateIndex:e.templateIndex,strings:[e.name||t,e.symbol||r],addresses:[e.minter,e.paymentCollector,e.mpFeeAddress,e.feeToken],uints:[P.default.utils.toWei(e.cap),P.default.utils.toWei(e.feeAmount)],bytess:[]}}function _(e){return{exchangeContract:e.exchangeContract,exchangeId:e.exchangeId,maxBaseTokenAmount:P.default.utils.toWei(e.maxBaseTokenAmount),swapMarketFee:P.default.utils.toWei(e.swapMarketFee),marketFeeAddress:e.marketFeeAddress}}function B(e){e.allowedConsumer||(e.allowedConsumer="0x0000000000000000000000000000000000000000");var t=e.withMint?1:0;return{fixedPriceAddress:e.fixedRateAddress,addresses:[e.baseTokenAddress,e.owner,e.marketFeeCollector,e.allowedConsumer],uints:[e.baseTokenDecimals,e.datatokenDecimals,P.default.utils.toWei(e.fixedRate),P.default.utils.toWei(e.marketFee),t]}}var q=function(e){try{return Promise.resolve(p.default(e,{method:"GET",headers:{"Content-type":"application/json"}}))}catch(e){return Promise.reject(e)}};function z(){return z=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},z.apply(this,arguments)}function H(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function J(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return H(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?H(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var Z={chainId:null,network:"unknown",metadataCacheUri:"https://v4.aquarius.oceanprotocol.com",nodeUri:"http://127.0.0.1:8545",providerUri:"http://127.0.0.1:8030",subgraphUri:null,explorerUri:null,oceanTokenAddress:null,oceanTokenSymbol:"OCEAN",poolTemplateAddress:null,fixedRateExchangeAddress:null,dispenserAddress:null,startBlock:0,transactionBlockTimeout:50,transactionConfirmationBlocks:1,transactionPollingTimeout:750,gasFeeMultiplier:1},V=[z({},Z),z({},Z,{chainId:8996,network:"development",metadataCacheUri:"http://127.0.0.1:5000"}),z({},Z,{chainId:3,network:"ropsten",nodeUri:"https://ropsten.infura.io/v3",providerUri:"https://v4.provider.ropsten.oceanprotocol.com",subgraphUri:"https://v4.subgraph.ropsten.oceanprotocol.com",explorerUri:"https://ropsten.etherscan.io",gasFeeMultiplier:1.1}),z({},Z,{chainId:4,network:"rinkeby",nodeUri:"https://rinkeby.infura.io/v3",providerUri:"https://v4.provider.rinkeby.oceanprotocol.com",subgraphUri:"https://v4.subgraph.rinkeby.oceanprotocol.com",explorerUri:"https://rinkeby.etherscan.io",gasFeeMultiplier:1.1}),z({},Z,{chainId:1,network:"mainnet",nodeUri:"https://mainnet.infura.io/v3",providerUri:"https://v4.provider.mainnet.oceanprotocol.com",subgraphUri:"https://v4.subgraph.mainnet.oceanprotocol.com",explorerUri:"https://etherscan.io",startBlock:11105459,transactionBlockTimeout:150,transactionConfirmationBlocks:5,transactionPollingTimeout:1750,gasFeeMultiplier:1.05}),z({},Z,{chainId:137,network:"polygon",nodeUri:"https://polygon-mainnet.infura.io/v3",providerUri:"https://v4.provider.polygon.oceanprotocol.com",subgraphUri:"https://v4.subgraph.polygon.oceanprotocol.com",explorerUri:"https://polygonscan.com",oceanTokenSymbol:"mOCEAN"}),z({},Z,{chainId:1287,network:"moonbase",nodeUri:"https://rpc.api.moonbase.moonbeam.network",providerUri:"https://v4.provider.moonbase.oceanprotocol.com",subgraphUri:"https://v4.subgraph.moonbase.oceanprotocol.com",explorerUri:"https://moonbase.moonscan.io/",gasFeeMultiplier:1.1}),z({},Z,{chainId:2021e3,network:"gaiaxtestnet",nodeUri:"https://rpc.gaiaxtestnet.oceanprotocol.com",providerUri:"https://v4.provider.gaiaxtestnet.oceanprotocol.com",subgraphUri:"https://v4.subgraph.gaiaxtestnet.oceanprotocol.com",explorerUri:"https://blockscout.gaiaxtestnet.oceanprotocol.com"}),z({},Z,{chainId:80001,network:"mumbai",nodeUri:"https://polygon-mumbai.infura.io/v3",providerUri:"https://v4.provider.mumbai.oceanprotocol.com",subgraphUri:"https://v4.subgraph.mumbai.oceanprotocol.com",explorerUri:"https://mumbai.polygonscan.com",gasFeeMultiplier:1.1}),z({},Z,{chainId:56,network:"bsc",nodeUri:"https://bsc-dataseed.binance.org",providerUri:"https://v4.provider.bsc.oceanprotocol.com",subgraphUri:"https://v4.subgraph.bsc.oceanprotocol.com",explorerUri:"https://bscscan.com/",gasFeeMultiplier:1.05}),z({},Z,{chainId:246,network:"energyweb",nodeUri:"https://rpc.energyweb.org",providerUri:"https://v4.provider.energyweb.oceanprotocol.com",subgraphUri:"https://v4.subgraph.energyweb.oceanprotocol.com",explorerUri:"https://explorer.energyweb.org",gasFeeMultiplier:1.05}),z({},Z,{chainId:1285,network:"moonriver",nodeUri:"https://moonriver.api.onfinality.io/public",providerUri:"https://v4.provider.moonriver.oceanprotocol.com",subgraphUri:"https://v4.subgraph.moonriver.oceanprotocol.com",explorerUri:"https://moonriver.moonscan.io/",gasFeeMultiplier:1.05})],X=/*#__PURE__*/function(){function e(){}var t=e.prototype;return t.getAddressesFromEnv=function(e,t){var r;if(t)try{var n=t[e];r=z({erc721FactoryAddress:n.ERC721Factory,sideStakingAddress:n.Staking,opfCommunityFeeCollector:n.OPFCommunityFeeCollector,poolTemplateAddress:n.poolTemplate,fixedRateExchangeAddress:n.FixedPrice,dispenserAddress:n.Dispenser,oceanTokenAddress:n.Ocean,chainId:n.chainId,startBlock:n.startBlock},process.env.AQUARIUS_URI&&{metadataCacheUri:process.env.AQUARIUS_URI})}catch(e){}else if(w.default[e]){var o=w.default[e];r=z({erc721FactoryAddress:o.ERC721Factory,sideStakingAddress:o.Staking,opfCommunityFeeCollector:o.OPFCommunityFeeCollector,poolTemplateAddress:o.poolTemplate,fixedRateExchangeAddress:o.FixedPrice,dispenserAddress:o.Dispenser,oceanTokenAddress:o.Ocean,chainId:o.chainId,startBlock:o.startBlock},process.env.AQUARIUS_URI&&{metadataCacheUri:process.env.AQUARIUS_URI})}return r},t.getConfig=function(e,t){var r="string"==typeof e?"network":"chainId",n=V.find(function(t){return t[r]===e});return n?(n=z({},n,this.getAddressesFromEnv(n.network)),z({},n,{nodeUri:t?n.nodeUri+"/"+t:n.nodeUri})):(I.error("No config found for given network '"+e+"'"),null)},e}(),Q="0x0000000000000000000000000000000000000000",K=1e6;function $(e,t){try{var r=e()}catch(e){return t(e)}return r&&r.then?r.then(void 0,t):r}var Y=function(e,t,r,n){try{var o=e.utils.utf8ToHex(t),i=e&&e.currentProvider&&e.currentProvider.isMetaMask;return Promise.resolve($(function(){return Promise.resolve(e.eth.personal.sign(o,r,n))},function(t){if(i)throw t;return I.warn("Error on personal sign."),I.warn(t),$(function(){return Promise.resolve(e.eth.sign(o,r))},function(e){throw I.error("Error on sign."),I.error(e),new Error("Error executing personal sign")})}))}catch(e){return Promise.reject(e)}},ee=function(e,t,r,n){try{var o=e&&e.currentProvider&&e.currentProvider.isMetaMask;return Promise.resolve($(function(){return Promise.resolve(e.eth.personal.sign(t,r,n))},function(n){if(o)throw n;return I.warn("Error on personal sign."),I.warn(n),$(function(){return Promise.resolve(e.eth.sign(t,r))},function(e){throw I.error("Error on sign."),I.error(e),new Error("Error executing personal sign")})}))}catch(e){return Promise.reject(e)}};function te(e,t){try{var r=e()}catch(e){return t(e)}return r&&r.then?r.then(void 0,t):r}var re=function(e,t,r,n){try{var o=new e.eth.Contract(G,t);return Promise.resolve(o.methods.allowance(r,n).call()).then(function(r){return Promise.resolve(O(e,t,r))})}catch(e){return Promise.reject(e)}},ne=function(e,t,r,n,o,i){try{var s,a=i||new e.eth.Contract(G,r),c=K,u=te(function(){return Promise.resolve(a.methods.approve(n,o).estimateGas({from:t},function(e,t){return e?c:t})).then(function(e){s=e})},function(e){s=c,I.error("estimate gas failed for approve!",e)});return Promise.resolve(u&&u.then?u.then(function(){return s}):s)}catch(e){return Promise.reject(e)}},oe=function(e){try{return Promise.resolve(new Promise(function(t){setTimeout(t,e)}))}catch(e){return Promise.reject(e)}},ie=function(e,t,r){try{return Promise.resolve(e.getReserve(t,r)).then(le)}catch(e){return Promise.reject(e)}},se=function(e,t,r){try{return Promise.resolve(e.getReserve(t,r)).then(le)}catch(e){return Promise.reject(e)}},ae=function(e,t,r){try{return Promise.resolve(e.getReserve(t,r)).then(le)}catch(e){return Promise.reject(e)}},ce=function(e,t,r){try{return Promise.resolve(e.getReserve(t,r)).then(ue)}catch(e){return Promise.reject(e)}};function ue(e){return new y.default(e).div(3.01)}function le(e){return new y.default(e).div(2.01)}function fe(e,t){try{var r=e()}catch(e){return t(e)}return r&&r.then?r.then(void 0,t):r}function he(e,t,r){if(!e.s){if(r instanceof me){if(!r.s)return void(r.o=he.bind(null,e,t));1&t&&(t=r.s),r=r.v}if(r&&r.then)return void r.then(he.bind(null,e,t),he.bind(null,e,2));e.s=t,e.v=r;var n=e.o;n&&n(e)}}var me=/*#__PURE__*/function(){function e(){}return e.prototype.then=function(t,r){var n=new e,o=this.s;if(o){var i=1&o?t:r;if(i){try{he(n,1,i(this.v))}catch(e){he(n,2,e)}return n}return this}return this.o=function(e){try{var o=e.v;1&e.s?he(n,1,t?t(o):o):r?he(n,1,r(o)):he(n,2,o)}catch(e){he(n,2,e)}},n},e}();function ve(e){return e instanceof me&&1&e.s}var de=/*#__PURE__*/function(){function e(e){this.aquariusURL=void 0,this.aquariusURL=e}var t=e.prototype;return t.resolve=function(e,t){try{var r=this.aquariusURL+"/api/aquarius/assets/ddo/"+e;return Promise.resolve(fe(function(){return Promise.resolve(p.default(r,{method:"GET",headers:{"Content-Type":"application/json"},signal:t})).then(function(e){if(e.ok)return Promise.resolve(e.json());throw new Error("HTTP request failed with status "+e.status)})},function(e){throw I.error(e),new Error("HTTP request failed")}))}catch(e){return Promise.reject(e)}},t.waitForAqua=function(e,t,r){try{var n,o=this,i=0,s=function(e,t){var r;do{var n=e();if(n&&n.then){if(!ve(n)){r=!0;break}n=n.v}var o=t();if(ve(o)&&(o=o.v),!o)return n}while(!o.then);var i=new me,s=he.bind(null,i,2);return(r?n.then(a):o.then(c)).then(void 0,s),i;function a(r){for(n=r;ve(o=t())&&(o=o.v),o;){if(o.then)return void o.then(c).then(void 0,s);if((n=e())&&n.then){if(!ve(n))return void n.then(a).then(void 0,s);n=n.v}}he(i,1,n)}function c(r){if(r){do{if((n=e())&&n.then){if(!ve(n))return void n.then(a).then(void 0,s);n=n.v}if(ve(r=t())&&(r=r.v),!r)return void he(i,1,n)}while(!r.then);r.then(c).then(void 0,s)}else he(i,1,n)}}(function(){function s(e){return n?e:Promise.resolve(oe(1500)).then(function(){i++})}var a=fe(function(){return Promise.resolve(p.default(o.aquariusURL+"/api/aquarius/assets/ddo/"+e,{method:"GET",headers:{"Content-Type":"application/json"},signal:r})).then(function(e){return function(){if(e.ok)return Promise.resolve(e.json()).then(function(e){return t?e.event&&e.event.txid===t?(n=1,e):void 0:(n=1,e)})}()})},function(){});return a&&a.then?a.then(s):s(a)},function(){return!n&&i<100});return Promise.resolve(s&&s.then?s.then(function(e){return n?e:null}):n?s:null)}catch(e){return Promise.reject(e)}},t.validate=function(e,t){try{var r,n=this,o={valid:!1},i=fe(function(){return Promise.resolve(p.default(n.aquariusURL+"/api/aquarius/assets/ddo/validate",{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/octet-stream"},signal:t})).then(function(e){return Promise.resolve(e.json()).then(function(t){r=t,200===e.status?(o.valid=!0,o.hash=r.hash,o.proof={validatorAddress:r.publicKey,r:r.r[0],s:r.s[0],v:r.v}):(o.errors=r,I.error("validate Metadata failed:",e.status,o.errors))})})},function(e){I.error("Error validating metadata: ",e)});return Promise.resolve(i&&i.then?i.then(function(){return o}):o)}catch(e){return Promise.reject(e)}},e}();function Pe(e,t){try{var r=e()}catch(e){return t(e)}return r&&r.then?r.then(void 0,t):r}var ge="115792089237316195423570985008687907853269984665640564039457584007913129639934";function pe(e,t,r){if(!e.s){if(r instanceof we){if(!r.s)return void(r.o=pe.bind(null,e,t));1&t&&(t=r.s),r=r.v}if(r&&r.then)return void r.then(pe.bind(null,e,t),pe.bind(null,e,2));e.s=t,e.v=r;const n=e.o;n&&n(e)}}var we=/*#__PURE__*/function(){function e(){}return e.prototype.then=function(t,r){var n=new e,o=this.s;if(o){var i=1&o?t:r;if(i){try{pe(n,1,i(this.v))}catch(e){pe(n,2,e)}return n}return this}return this.o=function(e){try{var o=e.v;1&e.s?pe(n,1,t?t(o):o):r?pe(n,1,r(o)):pe(n,2,o)}catch(e){pe(n,2,e)}},n},e}();function be(e){return e instanceof we&&1&e.s}function ye(e,t,r){for(var n;;){var o=e();if(be(o)&&(o=o.v),!o)return i;if(o.then){n=0;break}var i=r();if(i&&i.then){if(!be(i)){n=1;break}i=i.s}if(t){var s=t();if(s&&s.then&&!be(s)){n=2;break}}}var a=new we,c=pe.bind(null,a,2);return(0===n?o.then(l):1===n?i.then(u):s.then(f)).then(void 0,c),a;function u(n){i=n;do{if(t&&(s=t())&&s.then&&!be(s))return void s.then(f).then(void 0,c);if(!(o=e())||be(o)&&!o.v)return void pe(a,1,i);if(o.then)return void o.then(l).then(void 0,c);be(i=r())&&(i=i.v)}while(!i||!i.then);i.then(u).then(void 0,c)}function l(e){e?(i=r())&&i.then?i.then(u).then(void 0,c):u(i):pe(a,1,i)}function f(){(o=e())?o.then?o.then(l).then(void 0,c):l(o):pe(a,1,i)}}var Ae=/*#__PURE__*/function(){function e(e,t,r){void 0===t&&(t=null),this.poolAbi=void 0,this.web3=void 0,this.GASLIMIT_DEFAULT=1e6,this.config=void 0,this.poolAbi=t||A.default.abi,this.web3=e,this.config=r||V[0]}var t=e.prototype;return t.sharesBalance=function(e,t){try{var r=this,n=null,o=Pe(function(){var o=N(new r.web3.eth.Contract(r.poolAbi,t),r.config);return Promise.resolve(o.methods.balanceOf(e).call()).then(function(e){n=r.web3.utils.fromWei(e)})},function(e){I.error("ERROR: Failed to get shares of pool : "+e.message)});return Promise.resolve(o&&o.then?o.then(function(){return n}):n)}catch(e){return Promise.reject(e)}},t.estSetSwapFee=function(e,t,r,n){try{var o,i=this,s=n||N(new i.web3.eth.Contract(T.default.abi,t),i.config),a=i.GASLIMIT_DEFAULT,c=Pe(function(){return Promise.resolve(s.methods.setSwapFee(r).estimateGas({from:e},function(e,t){return e?a:t})).then(function(e){o=e})},function(){o=a});return Promise.resolve(c&&c.then?c.then(function(){return o}):o)}catch(e){return Promise.reject(e)}},t.setSwapFee=function(e,t,r){try{var n=this,o=N(new n.web3.eth.Contract(n.poolAbi,t,{from:e}),n.config),i=null;return Promise.resolve(n.estSetSwapFee(e,t,r)).then(function(t){var s=Pe(function(){var s=o.methods.setSwapFee(n.web3.utils.toWei(r)),a=s.send;return Promise.resolve(D(n.web3,n.config)).then(function(r){return Promise.resolve(a.call(s,{from:e,gas:t,gasPrice:r})).then(function(e){i=e})})},function(e){I.error("ERROR: Failed to set pool swap fee: "+e.message)});return s&&s.then?s.then(function(){return i}):i})}catch(e){return Promise.reject(e)}},t.getNumTokens=function(e){try{var t=this,r=N(new t.web3.eth.Contract(t.poolAbi,e),t.config),n=null,o=Pe(function(){return Promise.resolve(r.methods.getNumTokens().call()).then(function(e){n=e})},function(e){I.error("ERROR: Failed to get number of tokens: "+e.message)});return Promise.resolve(o&&o.then?o.then(function(){return n}):n)}catch(e){return Promise.reject(e)}},t.getPoolSharesTotalSupply=function(e){try{var t=this,r=N(new t.web3.eth.Contract(t.poolAbi,e),t.config),n=null,o=Pe(function(){return Promise.resolve(r.methods.totalSupply().call()).then(function(e){n=t.web3.utils.fromWei(e)})},function(e){I.error("ERROR: Failed to get total supply of pool shares: "+e.message)});return Promise.resolve(o&&o.then?o.then(function(){return n}):n)}catch(e){return Promise.reject(e)}},t.getCurrentTokens=function(e){try{var t=this,r=N(new t.web3.eth.Contract(t.poolAbi,e),t.config),n=null,o=Pe(function(){return Promise.resolve(r.methods.getCurrentTokens().call()).then(function(e){n=e})},function(e){I.error("ERROR: Failed to get tokens composing this pool: "+e.message)});return Promise.resolve(o&&o.then?o.then(function(){return n}):n)}catch(e){return Promise.reject(e)}},t.getFinalTokens=function(e){try{var t=this,r=N(new t.web3.eth.Contract(t.poolAbi,e),t.config),n=null,o=Pe(function(){return Promise.resolve(r.methods.getFinalTokens().call()).then(function(e){n=e})},function(e){I.error("ERROR: Failed to get the final tokens composing this pool "+e.message)});return Promise.resolve(o&&o.then?o.then(function(){return n}):n)}catch(e){return Promise.reject(e)}},t.getController=function(e){try{var t=this,r=N(new t.web3.eth.Contract(t.poolAbi,e),t.config),n=null,o=Pe(function(){return Promise.resolve(r.methods.getController().call()).then(function(e){n=e})},function(e){I.error("ERROR: Failed to get pool controller address: "+e.message)});return Promise.resolve(o&&o.then?o.then(function(){return n}):n)}catch(e){return Promise.reject(e)}},t.getBaseToken=function(e){try{var t=this,r=N(new t.web3.eth.Contract(t.poolAbi,e),t.config),n=null,o=Pe(function(){return Promise.resolve(r.methods.getBaseTokenAddress().call()).then(function(e){n=e})},function(e){I.error("ERROR: Failed to get baseToken address: "+e.message)});return Promise.resolve(o&&o.then?o.then(function(){return n}):n)}catch(e){return Promise.reject(e)}},t.getDatatoken=function(e){try{var t=this,r=N(new t.web3.eth.Contract(t.poolAbi,e),t.config),n=null,o=Pe(function(){return Promise.resolve(r.methods.getDatatokenAddress().call()).then(function(e){n=e})},function(e){I.error("ERROR: Failed to get datatoken address: "+e.message)});return Promise.resolve(o&&o.then?o.then(function(){return n}):n)}catch(e){return Promise.reject(e)}},t.getMarketFee=function(e){try{var t=function(){return r.web3.utils.fromWei(o).toString()},r=this,n=N(new r.web3.eth.Contract(r.poolAbi,e),r.config),o=null,i=Pe(function(){return Promise.resolve(n.methods.getMarketFee().call()).then(function(e){o=e})},function(e){I.error("ERROR: Failed to get getMarketFee: "+e.message)});return Promise.resolve(i&&i.then?i.then(t):t())}catch(e){return Promise.reject(e)}},t.getMarketFeeCollector=function(e){try{var t=this,r=N(new t.web3.eth.Contract(t.poolAbi,e),t.config),n=null,o=Pe(function(){return Promise.resolve(r.methods._publishMarketCollector().call()).then(function(e){n=e})},function(e){I.error("ERROR: Failed to get marketFeeCollector address: "+e.message)});return Promise.resolve(o&&o.then?o.then(function(){return n}):n)}catch(e){return Promise.reject(e)}},t.getOPCCollector=function(e){try{var t=this,r=N(new t.web3.eth.Contract(t.poolAbi,e),t.config),n=null,o=Pe(function(){return Promise.resolve(r.methods._opcCollector().call()).then(function(e){n=e})},function(e){I.error("ERROR: Failed to get OPF Collector address: "+e.message)});return Promise.resolve(o&&o.then?o.then(function(){return n}):n)}catch(e){return Promise.reject(e)}},t.isBound=function(e,t){try{var r=this,n=N(new r.web3.eth.Contract(r.poolAbi,e),r.config),o=null,i=Pe(function(){return Promise.resolve(n.methods.isBound(t).call()).then(function(e){o=e})},function(e){I.error("ERROR: Failed to check whether a token       bounded to a pool. "+e.message)});return Promise.resolve(i&&i.then?i.then(function(){return o}):o)}catch(e){return Promise.reject(e)}},t.getReserve=function(e,t){try{var r=function(){return o.toString()},n=this,o=null,i=Pe(function(){var r=N(new n.web3.eth.Contract(n.poolAbi,e),n.config);return Promise.resolve(r.methods.getBalance(t).call()).then(function(e){return Promise.resolve(O(n.web3,t,e)).then(function(e){o=e})})},function(e){I.error("ERROR: Failed to get how many tokens       are in the pool: "+e.message)});return Promise.resolve(i&&i.then?i.then(r):r())}catch(e){return Promise.reject(e)}},t.isFinalized=function(e){try{var t=this,r=N(new t.web3.eth.Contract(t.poolAbi,e),t.config),n=null,o=Pe(function(){return Promise.resolve(r.methods.isFinalized().call()).then(function(e){n=e})},function(e){I.error("ERROR: Failed to check whether pool is finalized: "+e.message)});return Promise.resolve(o&&o.then?o.then(function(){return n}):n)}catch(e){return Promise.reject(e)}},t.getSwapFee=function(e){try{var t=this,r=N(new t.web3.eth.Contract(t.poolAbi,e),t.config),n=null,o=Pe(function(){return Promise.resolve(r.methods.getSwapFee().call()).then(function(e){n=t.web3.utils.fromWei(e)})},function(e){I.error("ERROR: Failed to get pool fee: "+e.message)});return Promise.resolve(o&&o.then?o.then(function(){return n}):n)}catch(e){return Promise.reject(e)}},t.getNormalizedWeight=function(e,t){try{var r=this,n=N(new r.web3.eth.Contract(r.poolAbi,e),r.config),o=null,i=Pe(function(){return Promise.resolve(n.methods.getNormalizedWeight(t).call()).then(function(e){o=r.web3.utils.fromWei(e)})},function(e){I.error("ERROR: Failed to get normalized weight of a token: "+e.message)});return Promise.resolve(i&&i.then?i.then(function(){return o}):o)}catch(e){return Promise.reject(e)}},t.getDenormalizedWeight=function(e,t){try{var r=this,n=N(new r.web3.eth.Contract(r.poolAbi,e),r.config),o=null,i=Pe(function(){return Promise.resolve(n.methods.getDenormalizedWeight(t).call()).then(function(e){o=r.web3.utils.fromWei(e)})},function(e){I.error("ERROR: Failed to get denormalized weight of a token in pool "+e.message)});return Promise.resolve(i&&i.then?i.then(function(){return o}):o)}catch(e){return Promise.reject(e)}},t.getTotalDenormalizedWeight=function(e){try{var t=this,r=N(new t.web3.eth.Contract(t.poolAbi,e),t.config),n=null,o=Pe(function(){return Promise.resolve(r.methods.getTotalDenormalizedWeight().call()).then(function(e){n=t.web3.utils.fromWei(e)})},function(e){I.error("ERROR: Failed to get total denormalized weight in pool "+e.message)});return Promise.resolve(o&&o.then?o.then(function(){return n}):n)}catch(e){return Promise.reject(e)}},t.getMarketFees=function(e,t){try{var r=this,n=N(new r.web3.eth.Contract(r.poolAbi,e),r.config),o=null,i=Pe(function(){return Promise.resolve(n.methods.publishMarketFees(t).call()).then(function(e){return Promise.resolve(O(r.web3,t,e)).then(function(e){o=e})})},function(e){I.error("ERROR: Failed to get market fees for a token: "+e.message)});return Promise.resolve(i&&i.then?i.then(function(){return o}):o)}catch(e){return Promise.reject(e)}},t.getCurrentMarketFees=function(e){try{var t=this,r=N(new t.web3.eth.Contract(t.poolAbi,e),t.config);return Promise.resolve(Pe(function(){return Promise.resolve(r.methods.getCurrentOPCFees().call())},function(e){I.error("ERROR: Failed to get community fees for a token: "+e.message)}))}catch(e){return Promise.reject(e)}},t.getCurrentOPCFees=function(e){try{var t=this,r=N(new t.web3.eth.Contract(t.poolAbi,e),t.config);return Promise.resolve(Pe(function(){return Promise.resolve(r.methods.getCurrentOPCFees().call())},function(e){I.error("ERROR: Failed to get community fees for a token: "+e.message)}))}catch(e){return Promise.reject(e)}},t.getCommunityFees=function(e,t){try{var r=this,n=N(new r.web3.eth.Contract(r.poolAbi,e),r.config),o=null,i=Pe(function(){return Promise.resolve(n.methods.communityFees(t).call()).then(function(e){return Promise.resolve(O(r.web3,t,e)).then(function(e){o=e})})},function(e){I.error("ERROR: Failed to get community fees for a token: "+e.message)});return Promise.resolve(i&&i.then?i.then(function(){return o}):o)}catch(e){return Promise.reject(e)}},t.estCollectOPC=function(e,t,r){try{var n,o=this,i=r||N(new o.web3.eth.Contract(o.poolAbi,t),o.config),s=o.GASLIMIT_DEFAULT,a=Pe(function(){return Promise.resolve(i.methods.collectOPC().estimateGas({from:e},function(e,t){return e?s:t})).then(function(e){n=e})},function(){n=s});return Promise.resolve(a&&a.then?a.then(function(){return n}):n)}catch(e){return Promise.reject(e)}},t.collectOPC=function(e,t){try{var r=this,n=N(new r.web3.eth.Contract(r.poolAbi,t),r.config),o=null;return Promise.resolve(r.estCollectOPC(e,t)).then(function(t){var i=Pe(function(){var i=n.methods.collectOPC(),s=i.send;return Promise.resolve(D(r.web3,r.config)).then(function(r){return Promise.resolve(s.call(i,{from:e,gas:t+1,gasPrice:r})).then(function(e){o=e})})},function(e){I.error("ERROR: Failed to swap exact amount in : "+e.message)});return i&&i.then?i.then(function(){return o}):o})}catch(e){return Promise.reject(e)}},t.estCollectMarketFee=function(e,t,r){try{var n,o=this,i=r||N(new o.web3.eth.Contract(o.poolAbi,t),o.config),s=o.GASLIMIT_DEFAULT,a=Pe(function(){return Promise.resolve(i.methods.collectMarketFee().estimateGas({from:e},function(e,t){return e?s:t})).then(function(e){n=e})},function(){n=s});return Promise.resolve(a&&a.then?a.then(function(){return n}):n)}catch(e){return Promise.reject(e)}},t.collectMarketFee=function(e,t){try{var r=this;return Promise.resolve(r.getMarketFeeCollector(t)).then(function(n){if(n!==e)throw new Error("Caller is not MarketFeeCollector");var o=N(new r.web3.eth.Contract(r.poolAbi,t),r.config),i=null;return Promise.resolve(r.estCollectMarketFee(e,t)).then(function(t){var n=Pe(function(){var n=o.methods.collectMarketFee(),s=n.send;return Promise.resolve(D(r.web3,r.config)).then(function(r){return Promise.resolve(s.call(n,{from:e,gas:t+1,gasPrice:r})).then(function(e){i=e})})},function(e){I.error("ERROR: Failed to swap exact amount in : "+e.message)});return n&&n.then?n.then(function(){return i}):i})})}catch(e){return Promise.reject(e)}},t.estUpdatePublishMarketFee=function(e,t,r,n,o){try{var i,s=this,a=o||N(new s.web3.eth.Contract(s.poolAbi,t),s.config),c=s.GASLIMIT_DEFAULT,u=Pe(function(){return Promise.resolve(a.methods.updatePublishMarketFee(r,n).estimateGas({from:e},function(e,t){return e?c:t})).then(function(e){i=e})},function(){i=c});return Promise.resolve(u&&u.then?u.then(function(){return i}):i)}catch(e){return Promise.reject(e)}},t.updatePublishMarketFee=function(e,t,r,n){try{var o=this;return Promise.resolve(o.getMarketFeeCollector(t)).then(function(i){if(i!==e)throw new Error("Caller is not MarketFeeCollector");var s=N(new o.web3.eth.Contract(o.poolAbi,t),o.config),a=null;return Promise.resolve(o.estUpdatePublishMarketFee(e,t,r,o.web3.utils.toWei(n))).then(function(t){var i=Pe(function(){var i=s.methods.updatePublishMarketFee(r,o.web3.utils.toWei(n)),c=i.send;return Promise.resolve(D(o.web3,o.config)).then(function(r){return Promise.resolve(c.call(i,{from:e,gas:t+1,gasPrice:r})).then(function(e){a=e})})},function(e){I.error("ERROR: Failed to updatePublishMarketFee : "+e.message)});return i&&i.then?i.then(function(){return a}):a})})}catch(e){return Promise.reject(e)}},t.estSwapExactAmountIn=function(e,t,r,n,o){try{var i=this,s=o||N(new i.web3.eth.Contract(i.poolAbi,t),i.config);return Promise.resolve(L(i.web3,r.tokenIn,n.tokenAmountIn)).then(function(o){return Promise.resolve(L(i.web3,r.tokenOut,n.minAmountOut)).then(function(a){function c(t){var c,f=u?L(l,t,n.maxPrice):t,h=i.GASLIMIT_DEFAULT,m=Pe(function(){return Promise.resolve(s.methods.swapExactAmountIn([r.tokenIn,r.tokenOut,r.marketFeeAddress],[o,a,f,i.web3.utils.toWei(n.swapMarketFee)]).estimateGas({from:e},function(e,t){return e?h:t})).then(function(e){c=e})},function(){c=h});return m&&m.then?m.then(function(){return c}):c}var u=n.maxPrice,l=u&&i.web3;return u?Promise.resolve(i.getBaseToken(t)).then(c):c(ge)})})}catch(e){return Promise.reject(e)}},t.swapExactAmountIn=function(e,t,r,n){try{var o=this,i=N(new o.web3.eth.Contract(o.poolAbi,t),o.config);return Promise.resolve(ae(o,t,r.tokenIn)).then(function(s){if(new y.default(n.tokenAmountIn).greaterThan(s))throw new Error("tokenAmountIn is greater than "+s.toString());return Promise.resolve(o.estSwapExactAmountIn(e,t,r,n)).then(function(s){return Promise.resolve(L(o.web3,r.tokenIn,n.tokenAmountIn)).then(function(a){return Promise.resolve(L(o.web3,r.tokenOut,n.minAmountOut)).then(function(c){function u(e){return h?Promise.resolve(L(m,e,n.maxPrice)).then(l):e}function l(t){var u=Pe(function(){var u=i.methods.swapExactAmountIn([r.tokenIn,r.tokenOut,r.marketFeeAddress],[a,c,t,o.web3.utils.toWei(n.swapMarketFee)]),l=u.send;return Promise.resolve(D(o.web3,o.config)).then(function(t){return Promise.resolve(l.call(u,{from:e,gas:s+1,gasPrice:t})).then(function(e){f=e})})},function(e){I.error("ERROR: Failed to swap exact amount in : "+e.message)});return u&&u.then?u.then(function(){return f}):f}var f=null,h=n.maxPrice,m=h&&o.web3;return h?Promise.resolve(o.getBaseToken(t)).then(u):u(l(ge))})})})})}catch(e){return Promise.reject(e)}},t.estSwapExactAmountOut=function(e,t,r,n,o){try{var i=this,s=o||N(new i.web3.eth.Contract(i.poolAbi,t),i.config),a=i.GASLIMIT_DEFAULT;return Promise.resolve(L(i.web3,r.tokenIn,n.maxAmountIn)).then(function(o){return Promise.resolve(L(i.web3,r.tokenOut,n.tokenAmountOut)).then(function(c){function u(e){return f?Promise.resolve(L(h,e,n.maxPrice)).then(l):e}function l(t){var u,l=Pe(function(){return Promise.resolve(s.methods.swapExactAmountOut([r.tokenIn,r.tokenOut,r.marketFeeAddress],[o,c,t,i.web3.utils.toWei(n.swapMarketFee)]).estimateGas({from:e},function(e,t){return e?a:t})).then(function(e){u=e})},function(){u=a});return l&&l.then?l.then(function(){return u}):u}var f=n.maxPrice,h=f&&i.web3;return f?Promise.resolve(i.getBaseToken(t)).then(u):u(l(ge))})})}catch(e){return Promise.reject(e)}},t.swapExactAmountOut=function(e,t,r,n){try{var o=this,i=N(new o.web3.eth.Contract(o.poolAbi,t),o.config),s=null;return Promise.resolve(ce(o,t,r.tokenIn)).then(function(a){if(new y.default(n.tokenAmountOut).greaterThan(a))throw new Error("tokenAmountOut is greater than "+a.toString());return Promise.resolve(o.estSwapExactAmountOut(e,t,r,n)).then(function(a){return Promise.resolve(L(o.web3,r.tokenIn,n.maxAmountIn)).then(function(c){return Promise.resolve(L(o.web3,r.tokenOut,n.tokenAmountOut)).then(function(u){function l(t){var l=f?L(h,t,n.maxPrice):t,m=Pe(function(){var t=i.methods.swapExactAmountOut([r.tokenIn,r.tokenOut,r.marketFeeAddress],[c,u,l,o.web3.utils.toWei(n.swapMarketFee)]),f=t.send;return Promise.resolve(D(o.web3,o.config)).then(function(r){return Promise.resolve(f.call(t,{from:e,gas:a+1,gasPrice:r})).then(function(e){s=e})})},function(e){I.error("ERROR: Failed to swap exact amount out: "+e.message)});return m&&m.then?m.then(function(){return s}):s}var f=n.maxPrice,h=f&&o.web3;return f?Promise.resolve(o.getBaseToken(t)).then(l):l(ge)})})})})}catch(e){return Promise.reject(e)}},t.estJoinPool=function(e,t,r,n,o){try{var i,s=this,a=o||N(new s.web3.eth.Contract(s.poolAbi,t),s.config),c=s.GASLIMIT_DEFAULT,u=Pe(function(){return Promise.resolve(a.methods.joinPool(r,n).estimateGas({from:e},function(e,t){return e?c:t})).then(function(e){i=e})},function(){i=c});return Promise.resolve(u&&u.then?u.then(function(){return i}):i)}catch(e){return Promise.reject(e)}},t.joinPool=function(e,t,r,n){try{var o=this,i=N(new o.web3.eth.Contract(o.poolAbi,t),o.config),s=[];return Promise.resolve(o.getFinalTokens(t)).then(function(a){function c(){var n=null;return Promise.resolve(o.estJoinPool(e,t,o.web3.utils.toWei(r),s)).then(function(t){var a=Pe(function(){var a=i.methods.joinPool(o.web3.utils.toWei(r),s),c=a.send;return Promise.resolve(D(o.web3,o.config)).then(function(r){return Promise.resolve(c.call(a,{from:e,gas:t+1,gasPrice:r})).then(function(e){n=e})})},function(e){I.error("ERROR: Failed to join pool: "+e.message)});return a&&a.then?a.then(function(){return n}):n})}var u=0,l=ye(function(){return u<2},function(){return u++},function(){return Promise.resolve(L(o.web3,a[u],n[u])).then(function(e){s.push(e)})});return l&&l.then?l.then(c):c()})}catch(e){return Promise.reject(e)}},t.estExitPool=function(e,t,r,n,o){try{var i,s=this,a=o||N(new s.web3.eth.Contract(s.poolAbi,t),s.config),c=s.GASLIMIT_DEFAULT,u=Pe(function(){return Promise.resolve(a.methods.exitPool(r,n).estimateGas({from:e},function(e,t){return e?c:t})).then(function(e){i=e})},function(){i=c});return Promise.resolve(u&&u.then?u.then(function(){return i}):i)}catch(e){return Promise.reject(e)}},t.exitPool=function(e,t,r,n){try{var o=this,i=N(new o.web3.eth.Contract(o.poolAbi,t),o.config),s=[];return Promise.resolve(o.getFinalTokens(t)).then(function(a){function c(){var n=null;return Promise.resolve(o.estExitPool(e,t,o.web3.utils.toWei(r),s)).then(function(t){var a=Pe(function(){var a=i.methods.exitPool(o.web3.utils.toWei(r),s),c=a.send;return Promise.resolve(D(o.web3,o.config)).then(function(r){return Promise.resolve(c.call(a,{from:e,gas:t,gasPrice:r})).then(function(e){n=e})})},function(e){I.error("ERROR: Failed to exit pool: "+e.message)});return a&&a.then?a.then(function(){return n}):n})}var u=0,l=ye(function(){return u<2},function(){return u++},function(){return Promise.resolve(L(o.web3,a[u],n[u])).then(function(e){s.push(e)})});return l&&l.then?l.then(c):c()})}catch(e){return Promise.reject(e)}},t.estJoinswapExternAmountIn=function(e,t,r,n,o){try{var i,s=this,a=o||N(new s.web3.eth.Contract(s.poolAbi,t),s.config),c=s.GASLIMIT_DEFAULT,u=Pe(function(){return Promise.resolve(a.methods.joinswapExternAmountIn(r,n).estimateGas({from:e},function(e,t){return e?c:t})).then(function(e){i=e})},function(){i=c});return Promise.resolve(u&&u.then?u.then(function(){return i}):i)}catch(e){return Promise.reject(e)}},t.joinswapExternAmountIn=function(e,t,r,n){try{var o=this,i=N(new o.web3.eth.Contract(o.poolAbi,t),o.config),s=null;return Promise.resolve(o.getBaseToken(t)).then(function(a){return Promise.resolve(se(o,t,a)).then(function(c){if(new y.default(r).greaterThan(c))throw new Error("tokenAmountOut is greater than "+c.toString());return Promise.resolve(L(o.web3,a,r)).then(function(r){return Promise.resolve(o.estJoinswapExternAmountIn(e,t,r,o.web3.utils.toWei(n))).then(function(t){var a=Pe(function(){var a=i.methods.joinswapExternAmountIn(r,o.web3.utils.toWei(n)),c=a.send;return Promise.resolve(D(o.web3,o.config)).then(function(r){return Promise.resolve(c.call(a,{from:e,gas:t+1,gasPrice:r})).then(function(e){s=e})})},function(e){I.error("ERROR: Failed to pay tokens in order to       join the pool: "+e.message)});return a&&a.then?a.then(function(){return s}):s})})})})}catch(e){return Promise.reject(e)}},t.estExitswapPoolAmountIn=function(e,t,r,n,o){try{var i,s=this,a=o||N(new s.web3.eth.Contract(s.poolAbi,t),s.config),c=s.GASLIMIT_DEFAULT,u=Pe(function(){return Promise.resolve(a.methods.exitswapPoolAmountIn(r,n).estimateGas({from:e},function(e,t){return e?c:t})).then(function(e){i=e})},function(){i=c});return Promise.resolve(u&&u.then?u.then(function(){return i}):i)}catch(e){return Promise.reject(e)}},t.exitswapPoolAmountIn=function(e,t,r,n){try{var o=this,i=N(new o.web3.eth.Contract(o.poolAbi,t),o.config),s=null;return Promise.resolve(o.getBaseToken(t)).then(function(a){return Promise.resolve(o.calcSingleOutGivenPoolIn(t,a,r)).then(function(c){return Promise.resolve(ie(o,t,a)).then(function(a){if(new y.default(c).greaterThan(a))throw new Error("tokenAmountOut is greater than "+a.toString());var u=o.web3;return Promise.resolve(o.getBaseToken(t)).then(function(a){return Promise.resolve(L(u,a,n)).then(function(n){return Promise.resolve(o.estExitswapPoolAmountIn(e,t,o.web3.utils.toWei(r),n)).then(function(t){var a=Pe(function(){var a=i.methods.exitswapPoolAmountIn(o.web3.utils.toWei(r),n),c=a.send;return Promise.resolve(D(o.web3,o.config)).then(function(r){return Promise.resolve(c.call(a,{from:e,gas:t+1,gasPrice:r})).then(function(e){s=e})})},function(e){I.error("ERROR: Failed to pay pool shares into the pool: "+e.message)});return a&&a.then?a.then(function(){return s}):s})})})})})})}catch(e){return Promise.reject(e)}},t.getSpotPrice=function(e,t,r,n){try{var o=function(){function e(){function e(){var e;return a>c?(e=a-c,o=new g.default(o/Math.pow(10,e)),o/=Math.pow(10,c)):(e=c-a,o=new g.default(o*Math.pow(10,2*e)),o/=Math.pow(10,c)),o.toString()}var o=null,u=Pe(function(){return Promise.resolve(s.methods.getSpotPrice(t,r,i.web3.utils.toWei(n)).call()).then(function(e){o=new g.default((o=e).toString())})},function(){I.error("ERROR: Failed to get spot price of swapping tokenIn to tokenOut")});return u&&u.then?u.then(e):e()}var o=Pe(function(){return Promise.resolve(l.methods.decimals().call()).then(function(e){c=e})},function(e){I.error("ERROR: FAILED TO CALL DECIMALS(), USING 18 "+e.message)});return o&&o.then?o.then(e):e()},i=this,s=N(new i.web3.eth.Contract(i.poolAbi,e),i.config),a=18,c=18,u=N(new i.web3.eth.Contract(T.default.abi,t),i.config),l=N(new i.web3.eth.Contract(T.default.abi,r),i.config),f=Pe(function(){return Promise.resolve(u.methods.decimals().call()).then(function(e){a=e})},function(e){I.error("ERROR: FAILED TO CALL DECIMALS(), USING 18 "+e.message)});return Promise.resolve(f&&f.then?f.then(o):o())}catch(e){return Promise.reject(e)}},t.getAmountInExactOut=function(e,t,r,n,o){try{var i=this,s=N(new i.web3.eth.Contract(i.poolAbi,e),i.config);return Promise.resolve(ce(i,e,t)).then(function(e){if(new y.default(n).greaterThan(e))throw new Error("tokenAmountOut is greater than "+e.toString());return Promise.resolve(L(i.web3,r,n)).then(function(e){var n=null,a=Pe(function(){return Promise.resolve(s.methods.getAmountInExactOut(t,r,e,i.web3.utils.toWei(o)).call()).then(function(e){return Promise.resolve(O(i.web3,r,e.tokenAmountIn)).then(function(r){return Promise.resolve(O(i.web3,t,e.lpFeeAmount)).then(function(o){return Promise.resolve(O(i.web3,t,e.oceanFeeAmount)).then(function(s){return Promise.resolve(O(i.web3,t,e.publishMarketSwapFeeAmount)).then(function(a){return Promise.resolve(O(i.web3,t,e.consumeMarketSwapFeeAmount)).then(function(e){n={tokenAmount:r,liquidityProviderSwapFeeAmount:o,oceanFeeAmount:s,publishMarketSwapFeeAmount:a,consumeMarketSwapFeeAmount:e}})})})})})})},function(e){I.error("ERROR: Failed to calcInGivenOut "+e.message)});return a&&a.then?a.then(function(){return n}):n})})}catch(e){return Promise.reject(e)}},t.getAmountOutExactIn=function(e,t,r,n,o){try{var i=this,s=N(new i.web3.eth.Contract(i.poolAbi,e),i.config);return Promise.resolve(ae(i,e,t)).then(function(e){if(new y.default(n).greaterThan(e))throw new Error("tokenAmountIn is greater than "+e.toString());return Promise.resolve(L(i.web3,t,n)).then(function(e){var n=null,a=Pe(function(){return Promise.resolve(s.methods.getAmountOutExactIn(t,r,e,i.web3.utils.toWei(o)).call()).then(function(e){return Promise.resolve(O(i.web3,r,e.tokenAmountOut)).then(function(r){return Promise.resolve(O(i.web3,t,e.lpFeeAmount)).then(function(o){return Promise.resolve(O(i.web3,t,e.oceanFeeAmount)).then(function(s){return Promise.resolve(O(i.web3,t,e.publishMarketSwapFeeAmount)).then(function(a){return Promise.resolve(O(i.web3,t,e.consumeMarketSwapFeeAmount)).then(function(e){n={tokenAmount:r,liquidityProviderSwapFeeAmount:o,oceanFeeAmount:s,publishMarketSwapFeeAmount:a,consumeMarketSwapFeeAmount:e}})})})})})})},function(e){I.error("ERROR: Failed to calcOutGivenIn "+e.message)});return a&&a.then?a.then(function(){return n}):n})})}catch(e){return Promise.reject(e)}},t.calcPoolOutGivenSingleIn=function(e,t,r){try{var n=this,o=N(new n.web3.eth.Contract(n.poolAbi,e),n.config),i=null,s=Pe(function(){var s=o.methods,a=s.calcPoolOutSingleIn;return Promise.resolve(L(n.web3,t,r)).then(function(r){return Promise.resolve(a.call(s,t,r).call()).then(function(t){return Promise.resolve(O(n.web3,e,t)).then(function(e){i=e})})})},function(e){I.error("ERROR: Failed to calculate PoolOutGivenSingleIn : "+e.message)});return Promise.resolve(s&&s.then?s.then(function(){return i}):i)}catch(e){return Promise.reject(e)}},t.calcSingleInGivenPoolOut=function(e,t,r){try{var n=this,o=N(new n.web3.eth.Contract(n.poolAbi,e),n.config),i=null;return Promise.resolve(L(n.web3,e,r)).then(function(e){var r=Pe(function(){return Promise.resolve(o.methods.calcSingleInPoolOut(t,e).call()).then(function(e){return Promise.resolve(O(n.web3,t,e)).then(function(e){i=e})})},function(e){I.error("ERROR: Failed to calculate SingleInGivenPoolOut : "+e.message)});return r&&r.then?r.then(function(){return i}):i})}catch(e){return Promise.reject(e)}},t.calcSingleOutGivenPoolIn=function(e,t,r){try{var n=this,o=N(new n.web3.eth.Contract(n.poolAbi,e),n.config),i=null,s=Pe(function(){var s=o.methods,a=s.calcSingleOutPoolIn;return Promise.resolve(L(n.web3,e,r)).then(function(e){return Promise.resolve(a.call(s,t,e).call()).then(function(e){return Promise.resolve(O(n.web3,t,e)).then(function(e){i=e})})})},function(e){I.error("ERROR: Failed to calculate SingleOutGivenPoolIn : "+e)});return Promise.resolve(s&&s.then?s.then(function(){return i}):i)}catch(e){return Promise.reject(e)}},t.calcPoolInGivenSingleOut=function(e,t,r){try{var n=this,o=N(new n.web3.eth.Contract(n.poolAbi,e),n.config),i=null,s=Pe(function(){var s=o.methods,a=s.calcPoolInSingleOut;return Promise.resolve(L(n.web3,t,r)).then(function(r){return Promise.resolve(a.call(s,t,r).call()).then(function(t){return Promise.resolve(O(n.web3,e,t)).then(function(e){i=e})})})},function(e){I.error("ERROR: Failed to calculate PoolInGivenSingleOut : "+e.message)});return Promise.resolve(s&&s.then?s.then(function(){return i}):i)}catch(e){return Promise.reject(e)}},t.getSwapEventSignature=function(){var e=this.poolAbi.find(function(e){if("LOG_SWAP"===e.name&&"event"===e.type)return e});return this.web3.eth.abi.encodeEventSignature(e)},t.getJoinEventSignature=function(){var e=this.poolAbi.find(function(e){if("LOG_JOIN"===e.name&&"event"===e.type)return e});return this.web3.eth.abi.encodeEventSignature(e)},t.getExitEventSignature=function(){var e=this.poolAbi.find(function(e){if("LOG_EXIT"===e.name&&"event"===e.type)return e});return this.web3.eth.abi.encodeEventSignature(e)},e}();function Te(e,t){try{var r=e()}catch(e){return t(e)}return r&&r.then?r.then(void 0,t):r}var Ee,Ce=/*#__PURE__*/function(){function e(e,t,r,n){void 0===t&&(t=null),void 0===r&&(r=null),this.GASLIMIT_DEFAULT=1e6,this.web3=null,this.dispenserAddress=void 0,this.config=void 0,this.dispenserAbi=void 0,this.dispenserContract=void 0,this.web3=e,this.dispenserAddress=t,this.dispenserAbi=r||E.default.abi,this.config=n||V[0],e&&(this.dispenserContract=N(new this.web3.eth.Contract(this.dispenserAbi,this.dispenserAddress),this.config))}var t=e.prototype;return t.status=function(e){try{var t,r=this,n=Te(function(){return Promise.resolve(r.dispenserContract.methods.status(e).call()).then(function(e){return e.maxTokens=r.web3.utils.fromWei(e.maxTokens),e.maxBalance=r.web3.utils.fromWei(e.maxBalance),e.balance=r.web3.utils.fromWei(e.balance),t=1,e})},function(){I.warn("No dispenser available for datatoken: "+e)});return Promise.resolve(n&&n.then?n.then(function(e){return t?e:null}):t?n:null)}catch(e){return Promise.reject(e)}},t.estGasCreate=function(e,t,r,n,o){try{var i,s=this,a=s.GASLIMIT_DEFAULT,c=Te(function(){return Promise.resolve(s.dispenserContract.methods.create(e,s.web3.utils.toWei(r),s.web3.utils.toWei(n),t,o).estimateGas({from:t},function(e,t){return e?a:t})).then(function(e){i=e})},function(){i=a});return Promise.resolve(c&&c.then?c.then(function(){return i}):i)}catch(e){return Promise.reject(e)}},t.create=function(e,t,r,n,o){try{var i=this;return Promise.resolve(i.estGasCreate(e,t,r,n,o)).then(function(s){var a=i.dispenserContract.methods.create(e,i.web3.utils.toWei(r),i.web3.utils.toWei(n),t,o),c=a.send;return Promise.resolve(D(i.web3,i.config)).then(function(e){return Promise.resolve(c.call(a,{from:t,gas:s+1,gasPrice:e}))})})}catch(e){return Promise.reject(e)}},t.estGasActivate=function(e,t,r,n){try{var o,i=this,s=i.GASLIMIT_DEFAULT,a=Te(function(){return Promise.resolve(i.dispenserContract.methods.activate(e,i.web3.utils.toWei(t),i.web3.utils.toWei(r)).estimateGas({from:n},function(e,t){return e?s:t})).then(function(e){o=e})},function(){o=s});return Promise.resolve(a&&a.then?a.then(function(){return o}):o)}catch(e){return Promise.reject(e)}},t.activate=function(e,t,r,n){try{var o,i=this,s=Te(function(){return Promise.resolve(i.estGasActivate(e,t,r,n)).then(function(s){var a=i.dispenserContract.methods.activate(e,i.web3.utils.toWei(t),i.web3.utils.toWei(r)),c=a.send;return Promise.resolve(D(i.web3,i.config)).then(function(e){return Promise.resolve(c.call(a,{from:n,gas:s+1,gasPrice:e})).then(function(e){return o=1,e})})})},function(e){I.error("ERROR: Failed to activate dispenser: "+e.message)});return Promise.resolve(s&&s.then?s.then(function(e){return o?e:null}):o?s:null)}catch(e){return Promise.reject(e)}},t.estGasDeactivate=function(e,t){try{var r,n=this,o=n.GASLIMIT_DEFAULT,i=Te(function(){return Promise.resolve(n.dispenserContract.methods.deactivate(e).estimateGas({from:t},function(e,t){return e?o:t})).then(function(e){r=e})},function(){r=o});return Promise.resolve(i&&i.then?i.then(function(){return r}):r)}catch(e){return Promise.reject(e)}},t.deactivate=function(e,t){try{var r,n=this,o=Te(function(){return Promise.resolve(n.estGasDeactivate(e,t)).then(function(o){var i=n.dispenserContract.methods.deactivate(e),s=i.send;return Promise.resolve(D(n.web3,n.config)).then(function(e){return Promise.resolve(s.call(i,{from:t,gas:o+1,gasPrice:e})).then(function(e){return r=1,e})})})},function(e){I.error("ERROR: Failed to activate dispenser: "+e.message)});return Promise.resolve(o&&o.then?o.then(function(e){return r?e:null}):r?o:null)}catch(e){return Promise.reject(e)}},t.estGasSetAllowedSwapper=function(e,t,r){try{var n,o=this,i=o.GASLIMIT_DEFAULT,s=Te(function(){return Promise.resolve(o.dispenserContract.methods.setAllowedSwapper(e,r).estimateGas({from:t},function(e,t){return e?i:t})).then(function(e){n=e})},function(){n=i});return Promise.resolve(s&&s.then?s.then(function(){return n}):n)}catch(e){return Promise.reject(e)}},t.setAllowedSwapper=function(e,t,r){try{var n,o=this,i=Te(function(){return Promise.resolve(o.estGasSetAllowedSwapper(e,t,r)).then(function(i){var s=o.dispenserContract.methods.setAllowedSwapper(e,r),a=s.send;return Promise.resolve(D(o.web3,o.config)).then(function(e){return Promise.resolve(a.call(s,{from:t,gas:i+1,gasPrice:e})).then(function(e){return n=1,e})})})},function(e){I.error("ERROR: Failed to activate dispenser: "+e.message)});return Promise.resolve(i&&i.then?i.then(function(e){return n?e:null}):n?i:null)}catch(e){return Promise.reject(e)}},t.estGasDispense=function(e,t,r,n){void 0===r&&(r="1");try{var o,i=this,s=i.GASLIMIT_DEFAULT,a=Te(function(){return Promise.resolve(i.dispenserContract.methods.dispense(e,i.web3.utils.toWei(r),n).estimateGas({from:t},function(e,t){return e?s:t})).then(function(e){o=e})},function(){o=s});return Promise.resolve(a&&a.then?a.then(function(){return o}):o)}catch(e){return Promise.reject(e)}},t.dispense=function(e,t,r,n){void 0===r&&(r="1");try{var o=this;return Promise.resolve(o.estGasDispense(e,t,r,n)).then(function(i){var s,a=Te(function(){var a=o.dispenserContract.methods.dispense(e,o.web3.utils.toWei(r),n),c=a.send;return Promise.resolve(D(o.web3,o.config)).then(function(e){return Promise.resolve(c.call(a,{from:t,gas:i+1,gasPrice:e})).then(function(e){return s=1,e})})},function(e){I.error("ERROR: Failed to dispense tokens: "+e.message)});return a&&a.then?a.then(function(e){return s?e:null}):s?a:null})}catch(e){return Promise.reject(e)}},t.estGasOwnerWithdraw=function(e,t){try{var r,n=this,o=n.GASLIMIT_DEFAULT,i=Te(function(){return Promise.resolve(n.dispenserContract.methods.ownerWithdraw(e).estimateGas({from:t},function(e,t){return e?o:t})).then(function(e){r=e})},function(){r=o});return Promise.resolve(i&&i.then?i.then(function(){return r}):r)}catch(e){return Promise.reject(e)}},t.ownerWithdraw=function(e,t){try{var r=this;return Promise.resolve(r.estGasOwnerWithdraw(e,t)).then(function(n){var o,i=Te(function(){var i=r.dispenserContract.methods.ownerWithdraw(e),s=i.send;return Promise.resolve(D(r.web3,r.config)).then(function(e){return Promise.resolve(s.call(i,{from:t,gas:n+1,gasPrice:e})).then(function(e){return o=1,e})})},function(e){I.error("ERROR: Failed to withdraw tokens: "+e.message)});return i&&i.then?i.then(function(e){return o?e:null}):o?i:null})}catch(e){return Promise.reject(e)}},t.isDispensable=function(e,t,r,n){void 0===n&&(n="1");try{return Promise.resolve(this.status(e)).then(function(o){return!!o&&!1!==o.active&&Promise.resolve(t.balance(e,r)).then(function(e){return!(new y.default(e).greaterThanOrEqualTo(o.maxBalance)||new y.default(String(n)).greaterThan(o.maxTokens)||!new y.default(o.balance).greaterThanOrEqualTo(n)&&!0!==o.isMinter)})})}catch(e){return Promise.reject(e)}},e}();function ke(e,t){try{var r=e()}catch(e){return t(e)}return r&&r.then?r.then(void 0,t):r}e.FixedRateCreateProgressStep=void 0,(Ee=e.FixedRateCreateProgressStep||(e.FixedRateCreateProgressStep={}))[Ee.CreatingExchange=0]="CreatingExchange",Ee[Ee.ApprovingDatatoken=1]="ApprovingDatatoken";var Fe=/*#__PURE__*/function(){function e(e,t,r,n,o){void 0===r&&(r=null),void 0===n&&(n=null),this.GASLIMIT_DEFAULT=1e6,this.oceanAddress=null,this.fixedRateAddress=void 0,this.fixedRateExchangeAbi=void 0,this.fixedRateContract=void 0,this.web3=void 0,this.contract=null,this.config=void 0,this.ssAbi=void 0,this.web3=e,this.config=o||V[0],this.fixedRateExchangeAbi=r||C.default.abi,this.oceanAddress=n,this.fixedRateAddress=t,console.log("contract FRE config ",this.config),this.contract=N(new this.web3.eth.Contract(this.fixedRateExchangeAbi,this.fixedRateAddress),this.config)}var t=e.prototype;return t.amountToUnits=function(e,t){try{return Promise.resolve(L(this.web3,e,t))}catch(e){return Promise.reject(e)}},t.unitsToAmount=function(e,t){try{return Promise.resolve(O(this.web3,e,t))}catch(e){return Promise.reject(e)}},t.generateExchangeId=function(e,t){try{return Promise.resolve(this.contract.methods.generateExchangeId(e,t).call())}catch(e){return Promise.reject(e)}},t.estBuyDT=function(e,t,r,n,o,i,s){try{var a,c=s||this.fixedRateContract,u=this.GASLIMIT_DEFAULT,l=ke(function(){return Promise.resolve(c.methods.buyDT(t,r,n,o,i).estimateGas({from:e},function(e,t){return e?u:t})).then(function(e){a=e})},function(){a=u});return Promise.resolve(l&&l.then?l.then(function(){return a}):a)}catch(e){return Promise.reject(e)}},t.buyDT=function(e,t,r,n,o,i){void 0===o&&(o="0x0000000000000000000000000000000000000000"),void 0===i&&(i="0");try{var s=this;return Promise.resolve(s.getExchange(t)).then(function(a){var c=s.web3.utils.toWei(i);return Promise.resolve(s.amountToUnits(a.datatoken,r)).then(function(r){return Promise.resolve(s.amountToUnits(a.baseToken,n)).then(function(n){return Promise.resolve(s.estBuyDT(e,t,r,n,o,c)).then(function(i){return ke(function(){var a=s.contract.methods.buyDT(t,r,n,o,c),u=a.send;return Promise.resolve(D(s.web3,s.config)).then(function(t){return Promise.resolve(u.call(a,{from:e,gas:i+1,gasPrice:t}))})},function(e){return I.error("ERROR: Failed to buy datatokens: "+e.message),null})})})})})}catch(e){return Promise.reject(e)}},t.estSellDT=function(e,t,r,n,o,i,s){try{var a,c=s||this.fixedRateContract,u=this.GASLIMIT_DEFAULT,l=ke(function(){return Promise.resolve(c.methods.sellDT(t,r,n,o,i).estimateGas({from:e},function(e,t){return e?u:t})).then(function(e){a=e})},function(){a=u});return Promise.resolve(l&&l.then?l.then(function(){return a}):a)}catch(e){return Promise.reject(e)}},t.sellDT=function(e,t,r,n,o,i){void 0===o&&(o="0x0000000000000000000000000000000000000000"),void 0===i&&(i="0");try{var s=this;return Promise.resolve(s.getExchange(t)).then(function(a){var c=s.web3.utils.toWei(i);return Promise.resolve(s.amountToUnits(a.datatoken,r)).then(function(r){return Promise.resolve(s.amountToUnits(a.baseToken,n)).then(function(n){return Promise.resolve(s.estBuyDT(e,t,r,n,o,c)).then(function(i){return ke(function(){var a=s.contract.methods.sellDT(t,r,n,o,c),u=a.send;return Promise.resolve(D(s.web3,s.config)).then(function(t){return Promise.resolve(u.call(a,{from:e,gas:i+1,gasPrice:t}))})},function(e){return I.error("ERROR: Failed to sell datatokens: "+e.message),null})})})})})}catch(e){return Promise.reject(e)}},t.getNumberOfExchanges=function(){try{return Promise.resolve(this.contract.methods.getNumberOfExchanges().call())}catch(e){return Promise.reject(e)}},t.estSetRate=function(e,t,r,n){try{var o,i=this,s=n||i.fixedRateContract,a=i.GASLIMIT_DEFAULT,c=ke(function(){var n=s.methods,c=n.setRate;return Promise.resolve(i.web3.utils.toWei(r)).then(function(r){return Promise.resolve(c.call(n,t,r).estimateGas({from:e},function(e,t){return e?a:t})).then(function(e){o=e})})},function(){o=a});return Promise.resolve(c&&c.then?c.then(function(){return o}):o)}catch(e){return Promise.reject(e)}},t.setRate=function(e,t,r){try{var n=this;return Promise.resolve(n.estSetRate(e,t,r)).then(function(o){var i=n.contract.methods.setRate(t,n.web3.utils.toWei(r)),s=i.send;return Promise.resolve(D(n.web3,n.config)).then(function(t){return Promise.resolve(s.call(i,{from:e,gas:o+1,gasPrice:t}))})})}catch(e){return Promise.reject(e)}},t.estSetAllowedSwapper=function(e,t,r,n){try{var o,i=n||this.fixedRateContract,s=this.GASLIMIT_DEFAULT,a=ke(function(){return Promise.resolve(i.methods.setRate(t,r).estimateGas({from:e},function(e,t){return e?s:t})).then(function(e){o=e})},function(){o=s});return Promise.resolve(a&&a.then?a.then(function(){return o}):o)}catch(e){return Promise.reject(e)}},t.setAllowedSwapper=function(e,t,r){try{var n=this;return Promise.resolve(n.estSetAllowedSwapper(e,t,r)).then(function(o){var i=n.contract.methods.setAllowedSwapper(t,r),s=i.send;return Promise.resolve(D(n.web3,n.config)).then(function(t){return Promise.resolve(s.call(i,{from:e,gas:o+1,gasPrice:t}))})})}catch(e){return Promise.reject(e)}},t.estActivate=function(e,t,r){try{var n,o=r||this.fixedRateContract,i=this.GASLIMIT_DEFAULT,s=ke(function(){return Promise.resolve(o.methods.toggleExchangeState(t).estimateGas({from:e},function(e,t){return e?i:t})).then(function(e){n=e})},function(){n=i});return Promise.resolve(s&&s.then?s.then(function(){return n}):n)}catch(e){return Promise.reject(e)}},t.activate=function(e,t){try{var r=this;return Promise.resolve(r.getExchange(t)).then(function(n){return n?!0===n.active?null:Promise.resolve(r.estActivate(e,t)).then(function(n){var o=r.contract.methods.toggleExchangeState(t),i=o.send;return Promise.resolve(D(r.web3,r.config)).then(function(t){return Promise.resolve(i.call(o,{from:e,gas:n+1,gasPrice:t}))})}):null})}catch(e){return Promise.reject(e)}},t.estDeactivate=function(e,t,r){try{var n,o=r||this.fixedRateContract,i=this.GASLIMIT_DEFAULT,s=ke(function(){return Promise.resolve(o.methods.toggleExchangeState(t).estimateGas({from:e},function(e,t){return e?i:t})).then(function(e){n=e})},function(){n=i});return Promise.resolve(s&&s.then?s.then(function(){return n}):n)}catch(e){return Promise.reject(e)}},t.deactivate=function(e,t){try{var r=this;return Promise.resolve(r.getExchange(t)).then(function(n){return n?!1===n.active?null:Promise.resolve(r.estDeactivate(e,t)).then(function(n){var o=r.contract.methods.toggleExchangeState(t),i=o.send;return Promise.resolve(D(r.web3,r.config)).then(function(t){return Promise.resolve(i.call(o,{from:e,gas:n+1,gasPrice:t}))})}):null})}catch(e){return Promise.reject(e)}},t.getRate=function(e){try{var t=this;return Promise.resolve(t.contract.methods.getRate(e).call()).then(function(e){return Promise.resolve(t.web3.utils.fromWei(e))})}catch(e){return Promise.reject(e)}},t.getDTSupply=function(e){try{var t=this;return Promise.resolve(t.contract.methods.getDTSupply(e).call()).then(function(r){var n=t.unitsToAmount;return Promise.resolve(t.getExchange(e)).then(function(e){return Promise.resolve(n.call(t,e.datatoken,r))})})}catch(e){return Promise.reject(e)}},t.getBTSupply=function(e){try{var t=this;return Promise.resolve(t.contract.methods.getBTSupply(e).call()).then(function(r){var n=t.unitsToAmount;return Promise.resolve(t.getExchange(e)).then(function(e){return Promise.resolve(n.call(t,e.baseToken,r))})})}catch(e){return Promise.reject(e)}},t.getAllowedSwapper=function(e){try{return Promise.resolve(this.contract.methods.getAllowedSwapper(e).call())}catch(e){return Promise.reject(e)}},t.calcBaseInGivenOutDT=function(e,t,r){void 0===r&&(r="0");try{var n=this;return Promise.resolve(n.getExchange(e)).then(function(o){console.log("contract calcBaseInGivenOutDT config ",n.contract.transactionBlockTimeout,n.contract.transactionConfirmationBlocks,n.contract.transactionPollingTimeout);var i=n.contract.methods,s=i.calcBaseInGivenOutDT;return Promise.resolve(n.amountToUnits(o.datatoken,t)).then(function(t){return Promise.resolve(s.call(i,e,t,n.web3.utils.toWei(r)).call()).then(function(e){return Promise.resolve(n.unitsToAmount(o.baseToken,e.baseTokenAmount)).then(function(t){return Promise.resolve(n.unitsToAmount(o.baseToken,e.marketFeeAmount)).then(function(r){return Promise.resolve(n.unitsToAmount(o.baseToken,e.oceanFeeAmount)).then(function(i){return Promise.resolve(n.unitsToAmount(o.baseToken,e.consumeMarketFeeAmount)).then(function(e){return{baseTokenAmount:t,marketFeeAmount:r,oceanFeeAmount:i,consumeMarketFeeAmount:e}})})})})})})})}catch(e){return Promise.reject(e)}},t.getAmountBTOut=function(e,t,r){void 0===r&&(r="0");try{var n=this;return Promise.resolve(n.getExchange(e)).then(function(o){var i=n.contract.methods,s=i.calcBaseOutGivenInDT;return Promise.resolve(n.amountToUnits(o.datatoken,t)).then(function(t){return Promise.resolve(s.call(i,e,t,n.web3.utils.toWei(r)).call()).then(function(t){var r=n.unitsToAmount;return Promise.resolve(n.getExchange(e)).then(function(e){return Promise.resolve(r.call(n,e.baseToken,t[0]))})})})})}catch(e){return Promise.reject(e)}},t.getExchange=function(e){try{var t=this;return Promise.resolve(t.contract.methods.getExchange(e).call()).then(function(r){return r.dtDecimals=r.dtDecimals.toString(),r.btDecimals=r.btDecimals.toString(),Promise.resolve(t.unitsToAmount(r.datatoken,r.dtBalance)).then(function(n){return r.dtBalance=n,Promise.resolve(t.unitsToAmount(r.baseToken,r.btBalance)).then(function(n){return r.btBalance=n,Promise.resolve(t.unitsToAmount(r.datatoken,r.dtSupply)).then(function(n){return r.dtSupply=n,Promise.resolve(t.unitsToAmount(r.baseToken,r.btSupply)).then(function(n){return r.btSupply=n,r.fixedRate=t.web3.utils.fromWei(r.fixedRate),r.exchangeId=e,r})})})})})}catch(e){return Promise.reject(e)}},t.getFeesInfo=function(e){try{var t=this;return Promise.resolve(t.contract.methods.getFeesInfo(e).call()).then(function(r){r.opcFee=t.web3.utils.fromWei(r.opcFee.toString()),r.marketFee=t.web3.utils.fromWei(r.marketFee.toString());var n=t.unitsToAmount;return Promise.resolve(t.getExchange(e)).then(function(o){return Promise.resolve(n.call(t,o.baseToken,r.marketFeeAvailable)).then(function(n){r.marketFeeAvailable=n;var o=t.unitsToAmount;return Promise.resolve(t.getExchange(e)).then(function(n){return Promise.resolve(o.call(t,n.baseToken,r.oceanFeeAvailable)).then(function(t){return r.oceanFeeAvailable=t,r.exchangeId=e,r})})})})})}catch(e){return Promise.reject(e)}},t.getExchanges=function(){try{return Promise.resolve(this.contract.methods.getExchanges().call())}catch(e){return Promise.reject(e)}},t.isActive=function(e){try{return Promise.resolve(this.contract.methods.isActive(e).call())}catch(e){return Promise.reject(e)}},t.estActivateMint=function(e,t,r){try{var n,o=r||this.fixedRateContract,i=this.GASLIMIT_DEFAULT,s=ke(function(){return Promise.resolve(o.methods.toggleMintState(t,!0).estimateGas({from:e},function(e,t){return e?i:t})).then(function(e){n=e})},function(){n=i});return Promise.resolve(s&&s.then?s.then(function(){return n}):n)}catch(e){return Promise.reject(e)}},t.activateMint=function(e,t){try{var r=this;return Promise.resolve(r.getExchange(t)).then(function(n){return n?!0===n.withMint?null:Promise.resolve(r.estActivateMint(e,t)).then(function(n){var o=r.contract.methods.toggleMintState(t,!0),i=o.send;return Promise.resolve(D(r.web3,r.config)).then(function(t){return Promise.resolve(i.call(o,{from:e,gas:n+1,gasPrice:t}))})}):null})}catch(e){return Promise.reject(e)}},t.estDeactivateMint=function(e,t,r){try{var n,o=r||this.fixedRateContract,i=this.GASLIMIT_DEFAULT,s=ke(function(){return Promise.resolve(o.methods.toggleMintState(t).estimateGas({from:e},function(e,t){return e?i:t})).then(function(e){n=e})},function(){n=i});return Promise.resolve(s&&s.then?s.then(function(){return n}):n)}catch(e){return Promise.reject(e)}},t.deactivateMint=function(e,t){try{var r=this;return Promise.resolve(r.getExchange(t)).then(function(n){return n?!1===n.withMint?null:Promise.resolve(r.estDeactivate(e,t)).then(function(n){var o=r.contract.methods.toggleMintState(t,!1),i=o.send;return Promise.resolve(D(r.web3,r.config)).then(function(t){return Promise.resolve(i.call(o,{from:e,gas:n+1,gasPrice:t}))})}):null})}catch(e){return Promise.reject(e)}},t.estCollectBT=function(e,t,r,n){try{var o,i=this,s=n||i.fixedRateContract,a=i.GASLIMIT_DEFAULT;return Promise.resolve(i.contract.methods.getExchange(t).call()).then(function(n){return Promise.resolve(i.amountToUnits(n.baseToken,r)).then(function(r){var n=ke(function(){return Promise.resolve(s.methods.collectBT(t,r).estimateGas({from:e},function(e,t){return e?a:t})).then(function(e){o=e})},function(){o=a});return n&&n.then?n.then(function(){return o}):o})})}catch(e){return Promise.reject(e)}},t.collectBT=function(e,t,r){try{var n=this;return Promise.resolve(n.getExchange(t)).then(function(o){return o?Promise.resolve(n.estCollectBT(e,t,r)).then(function(o){return Promise.resolve(n.contract.methods.getExchange(t).call()).then(function(i){return Promise.resolve(n.amountToUnits(i.baseToken,r)).then(function(r){var i=n.contract.methods.collectBT(t,r),s=i.send;return Promise.resolve(D(n.web3,n.config)).then(function(t){return Promise.resolve(s.call(i,{from:e,gas:o+1,gasPrice:t}))})})})}):null})}catch(e){return Promise.reject(e)}},t.estCollectDT=function(e,t,r,n){try{var o,i=this,s=n||i.fixedRateContract,a=i.GASLIMIT_DEFAULT;return Promise.resolve(i.contract.methods.getExchange(t).call()).then(function(n){return Promise.resolve(i.amountToUnits(n.datatoken,r)).then(function(r){var n=ke(function(){return Promise.resolve(s.methods.collectDT(t,r).estimateGas({from:e},function(e,t){return e?a:t})).then(function(e){o=e})},function(){o=a});return n&&n.then?n.then(function(){return o}):o})})}catch(e){return Promise.reject(e)}},t.collectDT=function(e,t,r){try{var n=this;return Promise.resolve(n.getExchange(t)).then(function(o){return o?Promise.resolve(n.estCollectDT(e,t,r)).then(function(o){return Promise.resolve(n.contract.methods.getExchange(t).call()).then(function(i){return Promise.resolve(n.amountToUnits(i.datatoken,r)).then(function(r){var i=n.contract.methods.collectDT(t,r),s=i.send;return Promise.resolve(D(n.web3,n.config)).then(function(t){return Promise.resolve(s.call(i,{from:e,gas:o+1,gasPrice:t}))})})})}):null})}catch(e){return Promise.reject(e)}},t.estCollectMarketFee=function(e,t,r){try{var n,o=r||this.fixedRateContract,i=this.GASLIMIT_DEFAULT,s=ke(function(){return Promise.resolve(o.methods.collectMarketFee(t).estimateGas({from:e},function(e,t){return e?i:t})).then(function(e){n=e})},function(){n=i});return Promise.resolve(s&&s.then?s.then(function(){return n}):n)}catch(e){return Promise.reject(e)}},t.collectMarketFee=function(e,t){try{var r=this;return Promise.resolve(r.getExchange(t)).then(function(n){return n?Promise.resolve(r.estCollectMarketFee(e,t)).then(function(n){var o=r.contract.methods.collectMarketFee(t),i=o.send;return Promise.resolve(D(r.web3,r.config)).then(function(t){return Promise.resolve(i.call(o,{from:e,gas:n+1,gasPrice:t}))})}):null})}catch(e){return Promise.reject(e)}},t.estCollectOceanFee=function(e,t,r){try{var n,o=r||this.fixedRateContract,i=this.GASLIMIT_DEFAULT,s=ke(function(){return Promise.resolve(o.methods.collectMarketFee(t).estimateGas({from:e},function(e,t){return e?i:t})).then(function(e){n=e})},function(){n=i});return Promise.resolve(s&&s.then?s.then(function(){return n}):n)}catch(e){return Promise.reject(e)}},t.collectOceanFee=function(e,t){try{var r=this;return Promise.resolve(r.getExchange(t)).then(function(n){return n?Promise.resolve(r.estCollectOceanFee(e,t)).then(function(n){var o=r.contract.methods.collectOceanFee(t),i=o.send;return Promise.resolve(D(r.web3,r.config)).then(function(t){return Promise.resolve(i.call(o,{from:e,gas:n+1,gasPrice:t}))})}):null})}catch(e){return Promise.reject(e)}},t.getOPCCollector=function(){try{var e=this,t=null,r=ke(function(){return Promise.resolve(e.contract.methods.opcCollector().call()).then(function(e){t=e})},function(e){I.error("ERROR: Failed to get OPC Collector address: "+e.message)});return Promise.resolve(r&&r.then?r.then(function(){return t}):t)}catch(e){return Promise.reject(e)}},t.getRouter=function(){try{var e=this,t=null,r=ke(function(){return Promise.resolve(e.contract.methods.router().call()).then(function(e){t=e})},function(e){I.error("ERROR: Failed to get Router address: "+e.message)});return Promise.resolve(r&&r.then?r.then(function(){return t}):t)}catch(e){return Promise.reject(e)}},t.getExchangeOwner=function(e){try{var t=this,r=null,n=ke(function(){return Promise.resolve(t.getExchange(e)).then(function(e){return Promise.resolve(e.exchangeOwner).then(function(e){r=e})})},function(e){I.error("ERROR: Failed to get OPF Collector address: "+e.message)});return Promise.resolve(n&&n.then?n.then(function(){return r}):r)}catch(e){return Promise.reject(e)}},t.estUpdateMarketFee=function(e,t,r,n){try{var o,i=n||this.fixedRateContract,s=this.GASLIMIT_DEFAULT,a=ke(function(){return Promise.resolve(i.methods.updateMarketFee(t,r).estimateGas({from:e},function(e,t){return e?s:t})).then(function(e){o=e})},function(){o=s});return Promise.resolve(a&&a.then?a.then(function(){return o}):o)}catch(e){return Promise.reject(e)}},t.updateMarketFee=function(e,t,r){try{var n=this;return Promise.resolve(n.estSetRate(e,t,n.web3.utils.toWei(r))).then(function(o){var i=n.contract.methods.updateMarketFee(t,n.web3.utils.toWei(r)),s=i.send;return Promise.resolve(D(n.web3,n.config)).then(function(t){return Promise.resolve(s.call(i,{from:e,gas:o+1,gasPrice:t}))})})}catch(e){return Promise.reject(e)}},t.estUpdateMarketFeeCollector=function(e,t,r,n){try{var o,i=n||this.fixedRateContract,s=this.GASLIMIT_DEFAULT,a=ke(function(){return Promise.resolve(i.methods.updateMarketFeeCollector(t,r).estimateGas({from:e},function(e,t){return e?s:t})).then(function(e){o=e})},function(){o=s});return Promise.resolve(a&&a.then?a.then(function(){return o}):o)}catch(e){return Promise.reject(e)}},t.updateMarketFeeCollector=function(e,t,r){try{var n=this;return Promise.resolve(n.estUpdateMarketFeeCollector(e,t,r)).then(function(o){var i=n.contract.methods.updateMarketFeeCollector(t,r),s=i.send;return Promise.resolve(D(n.web3,n.config)).then(function(t){return Promise.resolve(s.call(i,{from:e,gas:o+1,gasPrice:t}))})})}catch(e){return Promise.reject(e)}},e}();function Re(e,t){try{var r=e()}catch(e){return t(e)}return r&&r.then?r.then(void 0,t):r}var je=/*#__PURE__*/function(){function e(e,t,r){this.GASLIMIT_DEFAULT=1e6,this.factory721Address=void 0,this.factory721Abi=void 0,this.nftAbi=void 0,this.web3=void 0,this.startBlock=void 0,this.config=void 0,this.nftAbi=t||F.default.abi,this.web3=e,this.config=r||V[0]}var t=e.prototype;return t.estGasCreateErc20=function(e,t,r,n,o,i,s,a,c,u,l,f){try{var h,m=this,v=f||N(new m.web3.eth.Contract(m.nftAbi,e),m.config),d=m.GASLIMIT_DEFAULT,P=Re(function(){return Promise.resolve(v.methods.createERC20(l,[c,u],[r,n,o,i],[m.web3.utils.toWei(a),m.web3.utils.toWei(s)],[]).estimateGas({from:t},function(e,t){return e?d:t})).then(function(e){h=e})},function(){h=d});return Promise.resolve(P&&P.then?P.then(function(){return h}):h)}catch(e){return Promise.reject(e)}},t.createErc20=function(e,t,r,n,o,i,s,a,c,u,l){try{var f=this;return Promise.resolve(f.getNftPermissions(e,t)).then(function(h){if(!0!==h.deployERC20)throw new Error("Caller is not ERC20Deployer");if(l||(l=1),!c||!u){var m=M();c=m.name,u=m.symbol}var v=N(new f.web3.eth.Contract(f.nftAbi,e),f.config);return Promise.resolve(f.estGasCreateErc20(e,t,r,n,o,i,s,a,c,u,l,v)).then(function(e){var h=v.methods.createERC20(l,[c,u],[r,n,o,i],[f.web3.utils.toWei(a),f.web3.utils.toWei(s)],[]),m=h.send;return Promise.resolve(D(f.web3,f.config)).then(function(r){return Promise.resolve(m.call(h,{from:t,gas:e+1,gasPrice:r})).then(function(e){var t=null;try{t=e.events.TokenCreated.returnValues[0]}catch(e){I.error("ERROR: Failed to create datatoken : "+e.message)}return t})})})})}catch(e){return Promise.reject(e)}},t.estGasAddManager=function(e,t,r,n){try{var o,i=this,s=n||N(new i.web3.eth.Contract(i.nftAbi,e),i.config),a=i.GASLIMIT_DEFAULT,c=Re(function(){return Promise.resolve(s.methods.addManager(r).estimateGas({from:t},function(e,t){return e?a:t})).then(function(e){o=e})},function(){o=a});return Promise.resolve(c&&c.then?c.then(function(){return o}):o)}catch(e){return Promise.reject(e)}},t.addManager=function(e,t,r){try{var n=this,o=N(new n.web3.eth.Contract(n.nftAbi,e),n.config);return Promise.resolve(n.getNftOwner(e)).then(function(i){if(i!==t)throw new Error("Caller is not NFT Owner");return Promise.resolve(n.estGasAddManager(e,t,r,o)).then(function(e){var i=o.methods.addManager(r),s=i.send;return Promise.resolve(D(n.web3,n.config)).then(function(r){return Promise.resolve(s.call(i,{from:t,gas:e+1,gasPrice:r}))})})})}catch(e){return Promise.reject(e)}},t.estGasRemoveManager=function(e,t,r,n){try{var o,i=this,s=n||N(new i.web3.eth.Contract(i.nftAbi,e),i.config),a=i.GASLIMIT_DEFAULT,c=Re(function(){return Promise.resolve(s.methods.removeManager(r).estimateGas({from:t},function(e,t){return e?a:t})).then(function(e){o=e})},function(){o=a});return Promise.resolve(c&&c.then?c.then(function(){return o}):o)}catch(e){return Promise.reject(e)}},t.removeManager=function(e,t,r){try{var n=this,o=N(new n.web3.eth.Contract(n.nftAbi,e),n.config);return Promise.resolve(n.getNftOwner(e)).then(function(i){if(i!==t)throw new Error("Caller is not NFT Owner");return Promise.resolve(n.estGasRemoveManager(e,t,r,o)).then(function(e){var i=o.methods.removeManager(r),s=i.send;return Promise.resolve(D(n.web3,n.config)).then(function(r){return Promise.resolve(s.call(i,{from:t,gas:e+1,gasPrice:r}))})})})}catch(e){return Promise.reject(e)}},t.estGasAddErc20Deployer=function(e,t,r,n){try{var o,i=this,s=n||N(new i.web3.eth.Contract(i.nftAbi,e),i.config),a=i.GASLIMIT_DEFAULT,c=Re(function(){return Promise.resolve(s.methods.addToCreateERC20List(r).estimateGas({from:t},function(e,t){return e?a:t})).then(function(e){o=e})},function(){o=a});return Promise.resolve(c&&c.then?c.then(function(){return o}):o)}catch(e){return Promise.reject(e)}},t.addErc20Deployer=function(e,t,r){try{var n=this,o=N(new n.web3.eth.Contract(n.nftAbi,e),n.config);return Promise.resolve(n.getNftPermissions(e,t)).then(function(i){if(!0!==i.manager)throw new Error("Caller is not Manager");return Promise.resolve(n.estGasAddErc20Deployer(e,t,r,o)).then(function(e){var i=o.methods.addToCreateERC20List(r),s=i.send;return Promise.resolve(D(n.web3,n.config)).then(function(r){return Promise.resolve(s.call(i,{from:t,gas:e+1,gasPrice:r}))})})})}catch(e){return Promise.reject(e)}},t.estGasRemoveErc20Deployer=function(e,t,r,n){try{var o,i=this,s=n||N(new i.web3.eth.Contract(i.nftAbi,e),i.config),a=i.GASLIMIT_DEFAULT,c=Re(function(){return Promise.resolve(s.methods.removeFromCreateErc20List(r).estimateGas({from:t},function(e,t){return e?a:t})).then(function(e){o=e})},function(){o=a});return Promise.resolve(c&&c.then?c.then(function(){return o}):o)}catch(e){return Promise.reject(e)}},t.removeErc20Deployer=function(e,t,r){try{var n=this,o=N(new n.web3.eth.Contract(n.nftAbi,e),n.config);return Promise.resolve(n.getNftPermissions(e,t)).then(function(i){function s(i){if(a||t===r&&!0!==i.deployERC20)throw new Error("Caller is not Manager nor ERC20Deployer");return Promise.resolve(n.estGasRemoveErc20Deployer(e,t,r,o)).then(function(e){var i=o.methods.removeFromCreateERC20List(r),s=i.send;return Promise.resolve(D(n.web3,n.config)).then(function(r){return Promise.resolve(s.call(i,{from:t,gas:e+1,gasPrice:r}))})})}var a=!0!==i.manager;return a||t!==r?s(a||t===r&&n.getNftPermissions(e,t)):Promise.resolve(a||t===r&&n.getNftPermissions(e,t)).then(s)})}catch(e){return Promise.reject(e)}},t.estGasAddMetadataUpdater=function(e,t,r,n){try{var o,i=this,s=n||N(new i.web3.eth.Contract(i.nftAbi,e),i.config),a=i.GASLIMIT_DEFAULT,c=Re(function(){return Promise.resolve(s.methods.addToMetadataList(r).estimateGas({from:t},function(e,t){return e?a:t})).then(function(e){o=e})},function(){o=a});return Promise.resolve(c&&c.then?c.then(function(){return o}):o)}catch(e){return Promise.reject(e)}},t.addMetadataUpdater=function(e,t,r){try{var n=this,o=N(new n.web3.eth.Contract(n.nftAbi,e),n.config);return Promise.resolve(n.getNftPermissions(e,t)).then(function(i){if(!0!==i.manager)throw new Error("Caller is not Manager");return Promise.resolve(n.estGasAddMetadataUpdater(e,t,r,o)).then(function(e){var i=o.methods.addToMetadataList(r),s=i.send;return Promise.resolve(D(n.web3,n.config)).then(function(r){return Promise.resolve(s.call(i,{from:t,gas:e+1,gasPrice:r}))})})})}catch(e){return Promise.reject(e)}},t.esGasRemoveMetadataUpdater=function(e,t,r,n){try{var o,i=this,s=n||N(new i.web3.eth.Contract(i.nftAbi,e),i.config),a=i.GASLIMIT_DEFAULT,c=Re(function(){return Promise.resolve(s.methods.removeFromMetadataList(r).estimateGas({from:t},function(e,t){return e?a:t})).then(function(e){o=e})},function(){o=a});return Promise.resolve(c&&c.then?c.then(function(){return o}):o)}catch(e){return Promise.reject(e)}},t.removeMetadataUpdater=function(e,t,r){try{var n=this,o=N(new n.web3.eth.Contract(n.nftAbi,e),n.config);return Promise.resolve(n.getNftPermissions(e,t)).then(function(i){function s(i){if(a||t!==r&&!0!==i.updateMetadata)throw new Error("Caller is not Manager nor Metadata Updater");return Promise.resolve(n.esGasRemoveMetadataUpdater(e,t,r,o)).then(function(e){var i=o.methods.removeFromMetadataList(r),s=i.send;return Promise.resolve(D(n.web3,n.config)).then(function(r){return Promise.resolve(s.call(i,{from:t,gas:e+1,gasPrice:r}))})})}var a=!0!==i.manager;return a||t===r?s(a||t!==r&&n.getNftPermissions(e,t)):Promise.resolve(a||t!==r&&n.getNftPermissions(e,t)).then(s)})}catch(e){return Promise.reject(e)}},t.estGasAddStoreUpdater=function(e,t,r,n){try{var o,i=this,s=n||N(new i.web3.eth.Contract(i.nftAbi,e),i.config),a=i.GASLIMIT_DEFAULT,c=Re(function(){return Promise.resolve(s.methods.addTo725StoreList(r).estimateGas({from:t},function(e,t){return e?a:t})).then(function(e){o=e})},function(){o=a});return Promise.resolve(c&&c.then?c.then(function(){return o}):o)}catch(e){return Promise.reject(e)}},t.addStoreUpdater=function(e,t,r){try{var n=this,o=N(new n.web3.eth.Contract(n.nftAbi,e),n.config);return Promise.resolve(n.getNftPermissions(e,t)).then(function(i){if(!0!==i.manager)throw new Error("Caller is not Manager");return Promise.resolve(n.estGasAddStoreUpdater(e,t,r,o)).then(function(e){var i=o.methods.addTo725StoreList(r),s=i.send;return Promise.resolve(D(n.web3,n.config)).then(function(r){return Promise.resolve(s.call(i,{from:t,gas:e+1,gasPrice:r}))})})})}catch(e){return Promise.reject(e)}},t.estGasRemoveStoreUpdater=function(e,t,r,n){try{var o,i=this,s=n||N(new i.web3.eth.Contract(i.nftAbi,e),i.config),a=i.GASLIMIT_DEFAULT,c=Re(function(){return Promise.resolve(s.methods.removeFrom725StoreList(r).estimateGas({from:t},function(e,t){return e?a:t})).then(function(e){o=e})},function(){o=a});return Promise.resolve(c&&c.then?c.then(function(){return o}):o)}catch(e){return Promise.reject(e)}},t.removeStoreUpdater=function(e,t,r){try{var n=this,o=N(new n.web3.eth.Contract(n.nftAbi,e),n.config);return Promise.resolve(n.getNftPermissions(e,t)).then(function(i){function s(i){if(a||t!==r&&!0!==i.store)throw new Error("Caller is not Manager nor storeUpdater");return Promise.resolve(n.estGasRemoveStoreUpdater(e,t,r,o)).then(function(e){var i=o.methods.removeFrom725StoreList(r),s=i.send;return Promise.resolve(D(n.web3,n.config)).then(function(r){return Promise.resolve(s.call(i,{from:t,gas:e+1,gasPrice:r}))})})}var a=!0!==i.manager;return a||t===r?s(a||t!==r&&n.getNftPermissions(e,t)):Promise.resolve(a||t!==r&&n.getNftPermissions(e,t)).then(s)})}catch(e){return Promise.reject(e)}},t.estGasCleanPermissions=function(e,t,r){try{var n,o=this,i=r||N(new o.web3.eth.Contract(o.nftAbi,e),o.config),s=o.GASLIMIT_DEFAULT,a=Re(function(){return Promise.resolve(i.methods.cleanPermissions().estimateGas({from:t},function(e,t){return e?s:t})).then(function(e){n=e})},function(){n=s});return Promise.resolve(a&&a.then?a.then(function(){return n}):n)}catch(e){return Promise.reject(e)}},t.cleanPermissions=function(e,t){try{var r=this,n=N(new r.web3.eth.Contract(r.nftAbi,e),r.config);return Promise.resolve(r.getNftOwner(e)).then(function(o){if(o!==t)throw new Error("Caller is not NFT Owner");return Promise.resolve(r.estGasCleanPermissions(e,t,n)).then(function(e){var o=n.methods.cleanPermissions(),i=o.send;return Promise.resolve(D(r.web3,r.config)).then(function(r){return Promise.resolve(i.call(o,{from:t,gas:e+1,gasPrice:r}))})})})}catch(e){return Promise.reject(e)}},t.estGasTransferNft=function(e,t,r,n,o){try{var i,s=this,a=o||N(new s.web3.eth.Contract(s.nftAbi,e),s.config),c=s.GASLIMIT_DEFAULT,u=Re(function(){return Promise.resolve(a.methods.transferFrom(t,r,n).estimateGas({from:t},function(e,t){return e?c:t})).then(function(e){i=e})},function(){i=c});return Promise.resolve(u&&u.then?u.then(function(){return i}):i)}catch(e){return Promise.reject(e)}},t.transferNft=function(e,t,r,n){try{var o=this,i=N(new o.web3.eth.Contract(o.nftAbi,e),o.config);return Promise.resolve(o.getNftOwner(e)).then(function(s){if(s!==t)throw new Error("Caller is not NFT Owner");var a=n||1;return Promise.resolve(o.estGasTransferNft(e,t,r,a,i)).then(function(e){var n=i.methods.transferFrom(t,r,a),s=n.send;return Promise.resolve(D(o.web3,o.config)).then(function(r){return Promise.resolve(s.call(n,{from:t,gas:e+1,gasPrice:r}))})})})}catch(e){return Promise.reject(e)}},t.estGasSafeTransferNft=function(e,t,r,n,o){try{var i,s=this,a=o||N(new s.web3.eth.Contract(s.nftAbi,e),s.config),c=s.GASLIMIT_DEFAULT,u=Re(function(){return Promise.resolve(a.methods.safeTransferFrom(t,r,n).estimateGas({from:t},function(e,t){return e?c:t})).then(function(e){i=e})},function(){i=c});return Promise.resolve(u&&u.then?u.then(function(){return i}):i)}catch(e){return Promise.reject(e)}},t.safeTransferNft=function(e,t,r,n){try{var o=this,i=N(new o.web3.eth.Contract(o.nftAbi,e),o.config);return Promise.resolve(o.getNftOwner(e)).then(function(s){if(s!==t)throw new Error("Caller is not NFT Owner");var a=n||1;return Promise.resolve(o.estGasSafeTransferNft(e,t,r,a,i)).then(function(e){var n=i.methods.safeTransferFrom(t,r,a),s=n.send;return Promise.resolve(D(o.web3,o.config)).then(function(r){return Promise.resolve(s.call(n,{from:t,gas:e+1,gasPrice:r}))})})})}catch(e){return Promise.reject(e)}},t.estGasSetMetadata=function(e,t,r,n,o,i,s,a,c,u){try{var l=this,f=u||N(new l.web3.eth.Contract(l.nftAbi,e),l.config);c||(c=[]);var h,m=l.GASLIMIT_DEFAULT,v=Re(function(){return Promise.resolve(f.methods.setMetaData(r,n,o,i,s,a,c).estimateGas({from:t},function(e,t){return e?m:t})).then(function(e){h=e})},function(e){I.error("estGasSetMetadata error: ",e.message),h=m});return Promise.resolve(v&&v.then?v.then(function(){return h}):h)}catch(e){return Promise.reject(e)}},t.setMetadata=function(e,t,r,n,o,i,s,a,c){try{var u=this,l=N(new u.web3.eth.Contract(u.nftAbi,e),u.config);return c||(c=[]),Promise.resolve(u.getNftPermissions(e,t)).then(function(f){if(!f.updateMetadata)throw new Error("Caller is not Metadata updater");return Promise.resolve(u.estGasSetMetadata(e,t,r,n,o,i,s,a,c,l)).then(function(e){var f=l.methods.setMetaData(r,n,o,i,s,a,c),h=f.send;return Promise.resolve(D(u.web3,u.config)).then(function(r){return Promise.resolve(h.call(f,{from:t,gas:e+1,gasPrice:r}))})})})}catch(e){return Promise.reject(e)}},t.estGasSetMetadataAndTokenURI=function(e,t,r,n){try{var o,i=this,s=n||N(new i.web3.eth.Contract(i.nftAbi,e),i.config),a=i.GASLIMIT_DEFAULT,c=z({},r,{metadataProofs:r.metadataProofs||[]}),u=Re(function(){return Promise.resolve(s.methods.setMetaDataAndTokenURI(c).estimateGas({from:t},function(e,t){return e?a:t})).then(function(e){o=e})},function(){o=a});return Promise.resolve(u&&u.then?u.then(function(){return o}):o)}catch(e){return Promise.reject(e)}},t.setMetadataAndTokenURI=function(e,t,r){try{var n=this,o=N(new n.web3.eth.Contract(n.nftAbi,e),n.config);return Promise.resolve(n.getNftPermissions(e,t)).then(function(i){if(!i.updateMetadata)throw new Error("Caller is not Metadata updater");return Promise.resolve(n.estGasSetMetadataAndTokenURI(e,t,r,o)).then(function(e){var i=z({},r,{metadataProofs:r.metadataProofs||[]}),s=o.methods.setMetaDataAndTokenURI(i),a=s.send;return Promise.resolve(D(n.web3,n.config)).then(function(r){return Promise.resolve(a.call(s,{from:t,gas:e+1,gasPrice:r}))})})})}catch(e){return Promise.reject(e)}},t.estGasSetMetadataState=function(e,t,r,n){try{var o,i=this,s=n||N(new i.web3.eth.Contract(i.nftAbi,e),i.config),a=i.GASLIMIT_DEFAULT,c=Re(function(){return Promise.resolve(s.methods.setMetaDataState(r).estimateGas({from:t},function(e,t){return e?a:t})).then(function(e){o=e})},function(){o=a});return Promise.resolve(c&&c.then?c.then(function(){return o}):o)}catch(e){return Promise.reject(e)}},t.setMetadataState=function(e,t,r){try{var n=this,o=N(new n.web3.eth.Contract(n.nftAbi,e),n.config);return Promise.resolve(n.getNftPermissions(e,t)).then(function(i){if(!i.updateMetadata)throw new Error("Caller is not Metadata updater");return Promise.resolve(n.estGasSetMetadataState(e,t,r)).then(function(e){var i=o.methods.setMetaDataState(r),s=i.send;return Promise.resolve(D(n.web3,n.config)).then(function(r){return Promise.resolve(s.call(i,{from:t,gas:e+1,gasPrice:r}))})})})}catch(e){return Promise.reject(e)}},t.estSetTokenURI=function(e,t,r){try{var n,o=this,i=N(new o.web3.eth.Contract(o.nftAbi,e),o.config),s=o.GASLIMIT_DEFAULT,a=Re(function(){return Promise.resolve(i.methods.setTokenURI("1",r).estimateGas({from:t},function(e,t){return e?s:t})).then(function(e){n=e})},function(){n=s});return Promise.resolve(a&&a.then?a.then(function(){return n}):n)}catch(e){return Promise.reject(e)}},t.setTokenURI=function(e,t,r){try{var n=this,o=N(new n.web3.eth.Contract(n.nftAbi,e),n.config);return Promise.resolve(n.estSetTokenURI(e,t,r)).then(function(e){var i=o.methods.setTokenURI("1",r),s=i.send;return Promise.resolve(D(n.web3,n.config)).then(function(r){return Promise.resolve(s.call(i,{from:t,gas:e+1,gasPrice:r}))})})}catch(e){return Promise.reject(e)}},t.getNftOwner=function(e){try{var t=this,r=N(new t.web3.eth.Contract(t.nftAbi,e),t.config);return Promise.resolve(r.methods.ownerOf(1).call())}catch(e){return Promise.reject(e)}},t.getNftPermissions=function(e,t){try{var r=this,n=N(new r.web3.eth.Contract(r.nftAbi,e),r.config);return Promise.resolve(n.methods.getPermissions(t).call())}catch(e){return Promise.reject(e)}},t.getMetadata=function(e){try{var t=this,r=N(new t.web3.eth.Contract(t.nftAbi,e),t.config);return Promise.resolve(r.methods.getMetaData().call())}catch(e){return Promise.reject(e)}},t.isErc20Deployer=function(e,t){try{var r=this,n=N(new r.web3.eth.Contract(r.nftAbi,e),r.config);return Promise.resolve(n.methods.isERC20Deployer(t).call())}catch(e){return Promise.reject(e)}},t.getData=function(e,t){try{var r=this,n=N(new r.web3.eth.Contract(r.nftAbi,e),r.config);return Promise.resolve(n.methods.getData(t).call())}catch(e){return Promise.reject(e)}},t.getTokenURI=function(e,t){try{var r=this,n=N(new r.web3.eth.Contract(r.nftAbi,e),r.config);return Promise.resolve(n.methods.tokenURI(t).call())}catch(e){return Promise.reject(e)}},e}();function Ie(e,t){try{var r=e()}catch(e){return t(e)}return r&&r.then?r.then(void 0,t):r}var Se=/*#__PURE__*/function(){function e(e,t,r,n){this.GASLIMIT_DEFAULT=1e6,this.factoryAddress=void 0,this.factoryABI=void 0,this.datatokensAbi=void 0,this.datatokensEnterpriseAbi=void 0,this.web3=void 0,this.config=void 0,this.nft=void 0,this.web3=e,this.datatokensAbi=t||T.default.abi,this.datatokensEnterpriseAbi=r||k.default.abi,this.config=n||V[0],this.nft=new je(this.web3)}var t=e.prototype;return t.estGasApprove=function(e,t,r,n,o){try{var i,s=this,a=o||N(new s.web3.eth.Contract(s.datatokensAbi,e),s.config),c=s.GASLIMIT_DEFAULT,u=Ie(function(){return Promise.resolve(a.methods.approve(t,s.web3.utils.toWei(r)).estimateGas({from:n},function(e,t){return e?c:t})).then(function(e){i=e})},function(){i=c});return Promise.resolve(u&&u.then?u.then(function(){return i}):i)}catch(e){return Promise.reject(e)}},t.approve=function(e,t,r,n){try{var o=this,i=N(new o.web3.eth.Contract(o.datatokensAbi,e),o.config);return Promise.resolve(o.estGasApprove(e,t,r,n,i)).then(function(e){var s=i.methods.approve(t,o.web3.utils.toWei(r)),a=s.send;return Promise.resolve(D(o.web3,o.config)).then(function(t){return Promise.resolve(a.call(s,{from:n,gas:e+1,gasPrice:t}))})})}catch(e){return Promise.reject(e)}},t.estGasMint=function(e,t,r,n,o){try{var i,s=this,a=o||N(new s.web3.eth.Contract(s.datatokensAbi,e),s.config),c=s.GASLIMIT_DEFAULT,u=Ie(function(){return Promise.resolve(a.methods.mint(n||t,s.web3.utils.toWei(r)).estimateGas({from:t},function(e,t){return e?c:t})).then(function(e){i=e})},function(){i=c});return Promise.resolve(u&&u.then?u.then(function(){return i}):i)}catch(e){return Promise.reject(e)}},t.estGasCreateFixedRate=function(e,t,r,n){try{var o=this,i=n||N(new o.web3.eth.Contract(o.datatokensAbi,e),o.config),s=o.GASLIMIT_DEFAULT;r.allowedConsumer||(r.allowedConsumer="0x0000000000000000000000000000000000000000");var a,c=r.withMint?1:0,u=Ie(function(){return Promise.resolve(i.methods.createFixedRate(r.fixedRateAddress,[r.baseTokenAddress,t,r.marketFeeCollector,r.allowedConsumer],[r.baseTokenDecimals,r.datatokenDecimals,r.fixedRate,r.marketFee,c]).estimateGas({from:t},function(e,t){return e?s:t})).then(function(e){a=e})},function(){a=s});return Promise.resolve(u&&u.then?u.then(function(){return a}):a)}catch(e){return Promise.reject(e)}},t.createFixedRate=function(e,t,r){try{var n=this,o=N(new n.web3.eth.Contract(n.datatokensAbi,e),n.config);return Promise.resolve(n.isERC20Deployer(e,t)).then(function(i){if(!i)throw new Error("User is not ERC20 Deployer");r.allowedConsumer||(r.allowedConsumer="0x0000000000000000000000000000000000000000");var s=r.withMint?1:0;return Promise.resolve(n.estGasCreateFixedRate(e,t,r,o)).then(function(e){var i=o.methods.createFixedRate(r.fixedRateAddress,[r.baseTokenAddress,r.owner,r.marketFeeCollector,r.allowedConsumer],[r.baseTokenDecimals,r.datatokenDecimals,r.fixedRate,r.marketFee,s]),a=i.send;return Promise.resolve(D(n.web3,n.config)).then(function(r){return Promise.resolve(a.call(i,{from:t,gas:e+1,gasPrice:r}))})})})}catch(e){return Promise.reject(e)}},t.estGasCreateDispenser=function(e,t,r,n,o){try{var i=this,s=o||N(new i.web3.eth.Contract(i.datatokensAbi,e),i.config);n.allowedSwapper||(n.allowedSwapper="0x0000000000000000000000000000000000000000"),n.withMint||(n.withMint=!1);var a,c=i.GASLIMIT_DEFAULT,u=Ie(function(){return Promise.resolve(s.methods.createDispenser(r,n.maxTokens,n.maxBalance,n.withMint,n.allowedSwapper).estimateGas({from:t},function(e,t){return e?c:t})).then(function(e){a=e})},function(){a=c});return Promise.resolve(u&&u.then?u.then(function(){return a}):a)}catch(e){return Promise.reject(e)}},t.createDispenser=function(e,t,r,n){try{var o=this;return Promise.resolve(o.isERC20Deployer(e,t)).then(function(i){if(!i)throw new Error("User is not ERC20 Deployer");var s=N(new o.web3.eth.Contract(o.datatokensAbi,e),o.config);return n.allowedSwapper||(n.allowedSwapper="0x0000000000000000000000000000000000000000"),n.withMint||(n.withMint=!1),Promise.resolve(o.estGasCreateDispenser(e,t,r,n,s)).then(function(e){var i=s.methods.createDispenser(r,n.maxTokens,n.maxBalance,n.withMint,n.allowedSwapper),a=i.send;return Promise.resolve(D(o.web3,o.config)).then(function(r){return Promise.resolve(a.call(i,{from:t,gas:e+1,gasPrice:r}))})})})}catch(e){return Promise.reject(e)}},t.mint=function(e,t,r,n){try{var o=this,i=N(new o.web3.eth.Contract(o.datatokensAbi,e),o.config);return Promise.resolve(o.getDTPermissions(e,t)).then(function(s){if(!0!==s.minter)throw new Error("Caller is not Minter");return Promise.resolve(o.getCap(e)).then(function(s){if(new y.default(s).gte(r))return Promise.resolve(o.estGasMint(e,t,r,n,i)).then(function(e){var s=i.methods.mint(n||t,o.web3.utils.toWei(r)),a=s.send;return Promise.resolve(D(o.web3,o.config)).then(function(r){return Promise.resolve(a.call(s,{from:t,gas:e+1,gasPrice:r}))})});throw new Error("Mint amount exceeds cap available")})})}catch(e){return Promise.reject(e)}},t.estGasAddMinter=function(e,t,r,n){try{var o,i=this,s=n||N(new i.web3.eth.Contract(i.datatokensAbi,e),i.config),a=i.GASLIMIT_DEFAULT,c=Ie(function(){return Promise.resolve(s.methods.addMinter(r).estimateGas({from:t},function(e,t){return e?a:t})).then(function(e){o=e})},function(){o=a});return Promise.resolve(c&&c.then?c.then(function(){return o}):o)}catch(e){return Promise.reject(e)}},t.addMinter=function(e,t,r){try{var n=this,o=N(new n.web3.eth.Contract(n.datatokensAbi,e),n.config);return Promise.resolve(n.isERC20Deployer(e,t)).then(function(i){if(!0!==i)throw new Error("Caller is not ERC20Deployer");return Promise.resolve(n.estGasAddMinter(e,t,r,o)).then(function(e){var i=o.methods.addMinter(r),s=i.send;return Promise.resolve(D(n.web3,n.config)).then(function(r){return Promise.resolve(s.call(i,{from:t,gas:e+1,gasPrice:r}))})})})}catch(e){return Promise.reject(e)}},t.estGasRemoveMinter=function(e,t,r,n){try{var o,i=this,s=n||N(new i.web3.eth.Contract(i.datatokensAbi,e),i.config),a=i.GASLIMIT_DEFAULT,c=Ie(function(){return Promise.resolve(s.methods.removeMinter(r).estimateGas({from:t},function(e,t){return e?a:t})).then(function(e){o=e})},function(){o=a});return Promise.resolve(c&&c.then?c.then(function(){return o}):o)}catch(e){return Promise.reject(e)}},t.removeMinter=function(e,t,r){try{var n=this,o=N(new n.web3.eth.Contract(n.datatokensAbi,e),n.config);return Promise.resolve(n.isERC20Deployer(e,t)).then(function(i){if(!0!==i)throw new Error("Caller is not ERC20Deployer");return Promise.resolve(n.estGasRemoveMinter(e,t,r,o)).then(function(e){var i=o.methods.removeMinter(r),s=i.send;return Promise.resolve(D(n.web3,n.config)).then(function(r){return Promise.resolve(s.call(i,{from:t,gas:e+1,gasPrice:r}))})})})}catch(e){return Promise.reject(e)}},t.estGasAddPaymentManager=function(e,t,r,n){try{var o,i=this,s=n||N(new i.web3.eth.Contract(i.datatokensAbi,e),i.config),a=i.GASLIMIT_DEFAULT,c=Ie(function(){return Promise.resolve(s.methods.addPaymentManager(r).estimateGas({from:t},function(e,t){return e?a:t})).then(function(e){o=e})},function(){o=a});return Promise.resolve(c&&c.then?c.then(function(){return o}):o)}catch(e){return Promise.reject(e)}},t.addPaymentManager=function(e,t,r){try{var n=this,o=N(new n.web3.eth.Contract(n.datatokensAbi,e),n.config);return Promise.resolve(n.isERC20Deployer(e,t)).then(function(i){if(!0!==i)throw new Error("Caller is not ERC20Deployer");return Promise.resolve(n.estGasAddPaymentManager(e,t,r,o)).then(function(e){var i=o.methods.addPaymentManager(r),s=i.send;return Promise.resolve(D(n.web3,n.config)).then(function(r){return Promise.resolve(s.call(i,{from:t,gas:e+1,gasPrice:r}))})})})}catch(e){return Promise.reject(e)}},t.estGasRemovePaymentManager=function(e,t,r,n){try{var o,i=this,s=n||N(new i.web3.eth.Contract(i.datatokensAbi,e),i.config),a=i.GASLIMIT_DEFAULT,c=Ie(function(){return Promise.resolve(s.methods.removePaymentManager(r).estimateGas({from:t},function(e,t){return e?a:t})).then(function(e){o=e})},function(){o=a});return Promise.resolve(c&&c.then?c.then(function(){return o}):o)}catch(e){return Promise.reject(e)}},t.removePaymentManager=function(e,t,r){try{var n=this,o=N(new n.web3.eth.Contract(n.datatokensAbi,e),n.config);return Promise.resolve(n.isERC20Deployer(e,t)).then(function(i){if(!0!==i)throw new Error("Caller is not ERC20Deployer");return Promise.resolve(n.estGasRemovePaymentManager(e,t,r,o)).then(function(e){var i=o.methods.removePaymentManager(r),s=i.send;return Promise.resolve(D(n.web3,n.config)).then(function(r){return Promise.resolve(s.call(i,{from:t,gas:e+1,gasPrice:r}))})})})}catch(e){return Promise.reject(e)}},t.estGasSetPaymentCollector=function(e,t,r,n){try{var o,i=this,s=n||N(new i.web3.eth.Contract(i.datatokensAbi,e),i.config),a=i.GASLIMIT_DEFAULT,c=Ie(function(){return Promise.resolve(s.methods.setPaymentCollector(r).estimateGas({from:t},function(e,t){return e?a:t})).then(function(e){o=e})},function(){o=a});return Promise.resolve(c&&c.then?c.then(function(){return o}):o)}catch(e){return Promise.reject(e)}},t.setPaymentCollector=function(e,t,r){try{var n=this,o=N(new n.web3.eth.Contract(n.datatokensAbi,e),n.config);return Promise.resolve(n.getDTPermissions(e,t)).then(function(i){function s(i){function s(s){function c(i){if(!a&&!u&&!(null==i?void 0:i.deployERC20))throw new Error("Caller is not Fee Manager, owner or erc20 Deployer");return Promise.resolve(n.estGasSetPaymentCollector(e,t,r,o)).then(function(e){var i=o.methods.setPaymentCollector(r),s=i.send;return Promise.resolve(D(n.web3,n.config)).then(function(r){return Promise.resolve(s.call(i,{from:t,gas:e+1,gasPrice:r}))})})}var u=i&&s===t;return i&&!u?Promise.resolve(i&&!u&&n.nft.getNftPermissions(i,t)).then(c):c(i&&!u&&n.nft.getNftPermissions(i,t))}return i?Promise.resolve(n.nft.getNftOwner(i)).then(s):s(i)}var a=!0===i.paymentManager;return a?s(!a&&n.getNFTAddress(e)):Promise.resolve(!a&&n.getNFTAddress(e)).then(s)})}catch(e){return Promise.reject(e)}},t.getPaymentCollector=function(e){try{var t=this,r=N(new t.web3.eth.Contract(t.datatokensAbi,e),t.config);return Promise.resolve(r.methods.getPaymentCollector().call())}catch(e){return Promise.reject(e)}},t.transfer=function(e,t,r,n){try{var o=this.web3.utils.toWei(r);return Promise.resolve(this.transferWei(e,t,o,n))}catch(e){return Promise.reject(e)}},t.estGasTransfer=function(e,t,r,n,o){try{var i,s=this,a=o||N(new s.web3.eth.Contract(s.datatokensAbi,e),s.config),c=s.GASLIMIT_DEFAULT,u=Ie(function(){return Promise.resolve(a.methods.transfer(t,r).estimateGas({from:n},function(e,t){return e?c:t})).then(function(e){i=e})},function(){i=c});return Promise.resolve(u&&u.then?u.then(function(){return i}):i)}catch(e){return Promise.reject(e)}},t.transferWei=function(e,t,r,n){try{var o=this,i=N(new o.web3.eth.Contract(o.datatokensAbi,e),o.config);return Promise.resolve(Ie(function(){return Promise.resolve(o.estGasTransfer(e,t,r,n,i)).then(function(e){var s=i.methods.transfer(t,r),a=s.send;return Promise.resolve(D(o.web3,o.config)).then(function(t){return Promise.resolve(a.call(s,{from:n,gas:e+1,gasPrice:t}))})})},function(e){throw I.error("ERROR: Failed to transfer tokens: "+e.message),new Error("Failed Failed to transfer tokens: "+e.message)}))}catch(e){return Promise.reject(e)}},t.estGasStartOrder=function(e,t,r,n,o,i,s){try{var a,c=this,u=s||N(new c.web3.eth.Contract(c.datatokensAbi,e),c.config),l=c.GASLIMIT_DEFAULT,f=Ie(function(){return Promise.resolve(u.methods.startOrder(r,n,o,i).estimateGas({from:t},function(e,t){return e?l:t})).then(function(e){a=e})},function(){a=l});return Promise.resolve(f&&f.then?f.then(function(){return a}):a)}catch(e){return Promise.reject(e)}},t.startOrder=function(e,t,r,n,o,i){try{var s=this,a=N(new s.web3.eth.Contract(s.datatokensAbi,e),s.config);return i||(i={consumeMarketFeeAddress:"0x0000000000000000000000000000000000000000",consumeMarketFeeToken:"0x0000000000000000000000000000000000000000",consumeMarketFeeAmount:"0"}),Promise.resolve(a.methods.getPublishingMarketFee().call()).then(function(c){function u(c){return Ie(function(){return Promise.resolve(s.estGasStartOrder(e,t,r,n,o,i,a)).then(function(e){var c=a.methods.startOrder(r,n,o,i),u=c.send;return Promise.resolve(D(s.web3,s.config)).then(function(r){return Promise.resolve(u.call(c,{from:t,gas:e+1,gasPrice:r}))})})},function(e){throw I.error("ERROR: Failed to start order : "+e.message),new Error("Failed to start order: "+e.message)})}var l=[{token:o.providerFeeToken,feeAmount:o.providerFeeAmount},{token:i.consumeMarketFeeToken,feeAmount:parseFloat(i.consumeMarketFeeAmount)},{token:c[1],feeAmount:parseFloat(c[2])}],f=[];l.map(function(e){f.length>0?f.map(function(t){t.token===e.token?t.feeAmount+=e.feeAmount:f.push({token:e.token,feeAmount:e.feeAmount})}):f.push({token:e.token,feeAmount:e.feeAmount})});var h=f.map(function(e){try{return e.token===Q||0===e.feeAmount?Promise.resolve(e):Promise.resolve(re(s.web3,e.token,t,r)).then(function(t){if(new y.default(t).greaterThanOrEqualTo(new y.default(e.feeAmount)))throw I.error("ERROR: Failed checking allowance: "+e.token),new Error("allowance ("+t+") is too low");return e.currentAllowance=t,e})}catch(e){return Promise.reject(e)}}),m=Ie(function(){return Promise.resolve(Promise.all(h)).then(function(){})},function(e){throw I.error("ERROR: Failed checking allowance : "+e),new Error("Failed checking allowance: "+e)});return m&&m.then?m.then(u):u()})}catch(e){return Promise.reject(e)}},t.estGasBuyFromFreAndOrder=function(e,t,r,n,o){try{var i,s=this,a=o||new s.web3.eth.Contract(s.datatokensEnterpriseAbi,e),c=s.GASLIMIT_DEFAULT,u=Ie(function(){return Promise.resolve(a.methods.buyFromFreAndOrder(r,n).estimateGas({from:t},function(e,t){return e?c:t})).then(function(e){i=e})},function(){i=c});return Promise.resolve(u&&u.then?u.then(function(){return i}):i)}catch(e){return Promise.reject(e)}},t.buyFromFreAndOrder=function(e,t,r,n){try{var o=this,i=new o.web3.eth.Contract(o.datatokensEnterpriseAbi,e);return Promise.resolve(Ie(function(){var s=_(n);return Promise.resolve(o.estGasBuyFromFreAndOrder(e,t,r,s,i)).then(function(e){var n=i.methods.buyFromFreAndOrder(r,s),a=n.send;return Promise.resolve(D(o.web3,o.config)).then(function(r){return Promise.resolve(a.call(n,{from:t,gas:e+1,gasPrice:r}))})})},function(e){throw I.error("ERROR: Failed to buy DT From Fre And Order : "+e.message),new Error("Failed to buy DT From Fre And Order: "+e.message)}))}catch(e){return Promise.reject(e)}},t.estGasBuyFromDispenserAndOrder=function(e,t,r,n,o){try{var i,s=this,a=o||new s.web3.eth.Contract(s.datatokensEnterpriseAbi,e),c=s.GASLIMIT_DEFAULT,u=Ie(function(){return Promise.resolve(a.methods.buyFromDispenserAndOrder(r,n).estimateGas({from:t},function(e,t){return e?c:t})).then(function(e){i=e})},function(){i=c});return Promise.resolve(u&&u.then?u.then(function(){return i}):i)}catch(e){return Promise.reject(e)}},t.buyFromDispenserAndOrder=function(e,t,r,n){try{var o=this,i=new o.web3.eth.Contract(o.datatokensEnterpriseAbi,e);return Promise.resolve(Ie(function(){return Promise.resolve(o.estGasBuyFromDispenserAndOrder(e,t,r,n,i)).then(function(e){var s=i.methods.buyFromDispenserAndOrder(r,n),a=s.send;return Promise.resolve(D(o.web3,o.config)).then(function(r){return Promise.resolve(a.call(s,{from:t,gas:e+1,gasPrice:r}))})})},function(e){throw I.error("ERROR: Failed to buy DT From Fre And Order : "+e.message),new Error("Failed to buy DT From Fre And Order: "+e.message)}))}catch(e){return Promise.reject(e)}},t.estGasSetData=function(e,t,r,n){try{var o,i=this,s=n||N(new i.web3.eth.Contract(i.datatokensAbi,e),i.config),a=i.GASLIMIT_DEFAULT,c=Ie(function(){return Promise.resolve(s.methods.setData(r).estimateGas({from:t},function(e,t){return e?a:t})).then(function(e){o=e})},function(){o=a});return Promise.resolve(c&&c.then?c.then(function(){return o}):o)}catch(e){return Promise.reject(e)}},t.setData=function(e,t,r){try{var n=this;return Promise.resolve(n.isERC20Deployer(e,t)).then(function(o){if(!o)throw new Error("User is not ERC20 Deployer");var i=N(new n.web3.eth.Contract(n.datatokensAbi,e),n.config);return Promise.resolve(n.estGasSetData(e,t,r,i)).then(function(e){var o=i.methods.setData(r),s=o.send;return Promise.resolve(D(n.web3,n.config)).then(function(r){return Promise.resolve(s.call(o,{from:t,gas:e+1,gasPrice:r}))})})})}catch(e){return Promise.reject(e)}},t.estGasCleanPermissions=function(e,t,r){try{var n,o=this,i=r||N(new o.web3.eth.Contract(o.datatokensAbi,e),o.config),s=o.GASLIMIT_DEFAULT,a=Ie(function(){return Promise.resolve(i.methods.cleanPermissions().estimateGas({from:t},function(e,t){return e?s:t})).then(function(e){n=e})},function(){n=s});return Promise.resolve(a&&a.then?a.then(function(){return n}):n)}catch(e){return Promise.reject(e)}},t.cleanPermissions=function(e,t){try{var r=this,n=r.nft,o=n.getNftOwner;return Promise.resolve(r.getNFTAddress(e)).then(function(i){return Promise.resolve(o.call(n,i)).then(function(n){if(n!==t)throw new Error("Caller is NOT Nft Owner");var o=N(new r.web3.eth.Contract(r.datatokensAbi,e),r.config);return Promise.resolve(r.estGasCleanPermissions(e,t,o)).then(function(e){var n=o.methods.cleanPermissions(),i=n.send;return Promise.resolve(D(r.web3,r.config)).then(function(r){return Promise.resolve(i.call(n,{from:t,gas:e+1,gasPrice:r}))})})})})}catch(e){return Promise.reject(e)}},t.getDTPermissions=function(e,t){try{var r=this,n=N(new r.web3.eth.Contract(r.datatokensAbi,e),r.config);return Promise.resolve(n.methods.permissions(t).call())}catch(e){return Promise.reject(e)}},t.getCap=function(e){try{var t=this,r=N(new t.web3.eth.Contract(t.datatokensAbi,e),t.config);return Promise.resolve(r.methods.cap().call()).then(function(e){return t.web3.utils.fromWei(e)})}catch(e){return Promise.reject(e)}},t.getDecimals=function(e){try{var t=this,r=N(new t.web3.eth.Contract(t.datatokensAbi,e),t.config);return Promise.resolve(r.methods.decimals().call())}catch(e){return Promise.reject(e)}},t.getNFTAddress=function(e){try{var t=this,r=N(new t.web3.eth.Contract(t.datatokensAbi,e),t.config);return Promise.resolve(r.methods.getERC721Address().call())}catch(e){return Promise.reject(e)}},t.isERC20Deployer=function(e,t){try{var r=this,n=N(new r.web3.eth.Contract(r.datatokensAbi,e),r.config);return Promise.resolve(n.methods.isERC20Deployer(t).call())}catch(e){return Promise.reject(e)}},t.balance=function(e,t){try{var r=this,n=new r.web3.eth.Contract(r.datatokensAbi,e,{from:t});return Promise.resolve(n.methods.balanceOf(t).call()).then(function(e){return r.web3.utils.fromWei(e)})}catch(e){return Promise.reject(e)}},e}();function Me(e,t){try{var r=e()}catch(e){return t(e)}return r&&r.then?r.then(void 0,t):r}var Ge="0x0000000000000000000000000000000000000000",xe=/*#__PURE__*/function(){function e(e,t,r,n){this.GASLIMIT_DEFAULT=1e6,this.factory721Address=void 0,this.factory721Abi=void 0,this.web3=void 0,this.config=void 0,this.factory721=void 0,this.factory721Address=e,this.factory721Abi=r||R.default.abi,this.web3=t,this.config=n||V[0],this.factory721=N(new this.web3.eth.Contract(this.factory721Abi,this.factory721Address),this.config)}var t=e.prototype;return t.estGasCreateNFT=function(e,t){try{var r,n=this,o=n.GASLIMIT_DEFAULT,i=Me(function(){return Promise.resolve(n.factory721.methods.deployERC721Contract(t.name,t.symbol,t.templateIndex,Ge,Ge,t.tokenURI,t.transferable,t.owner).estimateGas({from:e},function(e,t){return e?o:t})).then(function(e){r=e})},function(){r=o});return Promise.resolve(i&&i.then?i.then(function(){return r}):r)}catch(e){return Promise.reject(e)}},t.createNFT=function(e,t){try{var r=this;if(t.templateIndex||(t.templateIndex=1),!t.name||!t.symbol){var n=M(),o=n.symbol;t.name=n.name,t.symbol=o}var i=t.templateIndex;return Promise.resolve(r.getCurrentNFTTemplateCount()).then(function(n){if(i>n)throw new Error("Template index doesnt exist");if(0===t.templateIndex)throw new Error("Template index cannot be ZERO");return Promise.resolve(r.getNFTTemplate(t.templateIndex)).then(function(n){if(!1===n.isActive)throw new Error("Template is not active");return Promise.resolve(r.estGasCreateNFT(e,t)).then(function(n){var o=r.factory721.methods.deployERC721Contract(t.name,t.symbol,t.templateIndex,Ge,Ge,t.tokenURI,t.transferable,t.owner),i=o.send;return Promise.resolve(D(r.web3,r.config)).then(function(t){return Promise.resolve(i.call(o,{from:e,gas:n+1,gasPrice:t})).then(function(e){var t=null;try{t=e.events.NFTCreated.returnValues[0]}catch(e){I.error("ERROR: Failed to create datatoken : "+e.message)}return t})})})})})}catch(e){return Promise.reject(e)}},t.getCurrentNFTCount=function(){try{return Promise.resolve(this.factory721.methods.getCurrentNFTCount().call())}catch(e){return Promise.reject(e)}},t.getCurrentTokenCount=function(){try{return Promise.resolve(this.factory721.methods.getCurrentTokenCount().call())}catch(e){return Promise.reject(e)}},t.getOwner=function(){try{return Promise.resolve(this.factory721.methods.owner().call())}catch(e){return Promise.reject(e)}},t.getCurrentNFTTemplateCount=function(){try{return Promise.resolve(this.factory721.methods.getCurrentNFTTemplateCount().call())}catch(e){return Promise.reject(e)}},t.getCurrentTokenTemplateCount=function(){try{return Promise.resolve(this.factory721.methods.getCurrentTemplateCount().call())}catch(e){return Promise.reject(e)}},t.getNFTTemplate=function(e){try{var t=this;return Promise.resolve(t.getCurrentNFTTemplateCount()).then(function(r){if(e>r)throw new Error("Template index doesnt exist");if(0===e)throw new Error("Template index cannot be ZERO");return Promise.resolve(t.factory721.methods.getNFTTemplate(e).call())})}catch(e){return Promise.reject(e)}},t.getTokenTemplate=function(e){try{return Promise.resolve(this.factory721.methods.getTokenTemplate(e).call())}catch(e){return Promise.reject(e)}},t.checkDatatoken=function(e){try{return Promise.resolve(this.factory721.methods.erc20List(e).call())}catch(e){return Promise.reject(e)}},t.checkNFT=function(e){try{return Promise.resolve(this.factory721.methods.erc721List(e).call())}catch(e){return Promise.reject(e)}},t.estGasAddNFTTemplate=function(e,t){try{var r,n=this,o=n.GASLIMIT_DEFAULT,i=Me(function(){return Promise.resolve(n.factory721.methods.add721TokenTemplate(t).estimateGas({from:e},function(e,t){return e?o:t})).then(function(e){r=e})},function(){r=o});return Promise.resolve(i&&i.then?i.then(function(){return r}):r)}catch(e){return Promise.reject(e)}},t.addNFTTemplate=function(e,t){try{var r=this;return Promise.resolve(r.getOwner()).then(function(n){if(n!==e)throw new Error("Caller is not Factory Owner");if(t===Ge)throw new Error("Template cannot be ZERO address");return Promise.resolve(r.estGasAddNFTTemplate(e,t)).then(function(n){var o=r.factory721.methods.add721TokenTemplate(t),i=o.send;return Promise.resolve(D(r.web3,r.config)).then(function(t){return Promise.resolve(i.call(o,{from:e,gas:n+1,gasPrice:t}))})})})}catch(e){return Promise.reject(e)}},t.estGasDisableNFTTemplate=function(e,t){try{var r,n=this,o=n.GASLIMIT_DEFAULT,i=Me(function(){return Promise.resolve(n.factory721.methods.disable721TokenTemplate(t).estimateGas({from:e},function(e,t){return e?o:t})).then(function(e){r=e})},function(){r=o});return Promise.resolve(i&&i.then?i.then(function(){return r}):r)}catch(e){return Promise.reject(e)}},t.disableNFTTemplate=function(e,t){try{var r=this;return Promise.resolve(r.getOwner()).then(function(n){if(n!==e)throw new Error("Caller is not Factory Owner");return Promise.resolve(r.getCurrentNFTTemplateCount()).then(function(n){if(t>n)throw new Error("Template index doesnt exist");if(0===t)throw new Error("Template index cannot be ZERO");return Promise.resolve(r.estGasDisableNFTTemplate(e,t)).then(function(n){var o=r.factory721.methods.disable721TokenTemplate(t),i=o.send;return Promise.resolve(D(r.web3,r.config)).then(function(t){return Promise.resolve(i.call(o,{from:e,gas:n+1,gasPrice:t}))})})})})}catch(e){return Promise.reject(e)}},t.estGasReactivateNFTTemplate=function(e,t){try{var r,n=this,o=n.GASLIMIT_DEFAULT,i=Me(function(){return Promise.resolve(n.factory721.methods.reactivate721TokenTemplate(t).estimateGas({from:e},function(e,t){return e?o:t})).then(function(e){r=e})},function(){r=o});return Promise.resolve(i&&i.then?i.then(function(){return r}):r)}catch(e){return Promise.reject(e)}},t.reactivateNFTTemplate=function(e,t){try{var r=this;return Promise.resolve(r.getOwner()).then(function(n){if(n!==e)throw new Error("Caller is not Factory Owner");return Promise.resolve(r.getCurrentNFTTemplateCount()).then(function(n){if(t>n)throw new Error("Template index doesnt exist");if(0===t)throw new Error("Template index cannot be ZERO");return Promise.resolve(r.estGasReactivateNFTTemplate(e,t)).then(function(n){var o=r.factory721.methods.reactivate721TokenTemplate(t),i=o.send;return Promise.resolve(D(r.web3,r.config)).then(function(t){return Promise.resolve(i.call(o,{from:e,gas:n+1,gasPrice:t}))})})})})}catch(e){return Promise.reject(e)}},t.estGasAddTokenTemplate=function(e,t){try{var r,n=this,o=n.GASLIMIT_DEFAULT,i=Me(function(){return Promise.resolve(n.factory721.methods.addTokenTemplate(t).estimateGas({from:e},function(e,t){return e?o:t})).then(function(e){r=e})},function(){r=o});return Promise.resolve(i&&i.then?i.then(function(){return r}):r)}catch(e){return Promise.reject(e)}},t.addTokenTemplate=function(e,t){try{var r=this;return Promise.resolve(r.getOwner()).then(function(n){if(n!==e)throw new Error("Caller is not Factory Owner");if(t===Ge)throw new Error("Template cannot be address ZERO");return Promise.resolve(r.estGasAddTokenTemplate(e,t)).then(function(n){var o=r.factory721.methods.addTokenTemplate(t),i=o.send;return Promise.resolve(D(r.web3,r.config)).then(function(t){return Promise.resolve(i.call(o,{from:e,gas:n+1,gasPrice:t}))})})})}catch(e){return Promise.reject(e)}},t.estGasDisableTokenTemplate=function(e,t){try{var r,n=this,o=n.GASLIMIT_DEFAULT,i=Me(function(){return Promise.resolve(n.factory721.methods.disableTokenTemplate(t).estimateGas({from:e},function(e,t){return e?o:t})).then(function(e){r=e})},function(){r=o});return Promise.resolve(i&&i.then?i.then(function(){return r}):r)}catch(e){return Promise.reject(e)}},t.disableTokenTemplate=function(e,t){try{var r=this;return Promise.resolve(r.getOwner()).then(function(n){if(n!==e)throw new Error("Caller is not Factory Owner");return Promise.resolve(r.getCurrentTokenTemplateCount()).then(function(n){if(t>n)throw new Error("Template index doesnt exist");if(0===t)throw new Error("Template index cannot be ZERO");return Promise.resolve(r.getTokenTemplate(t)).then(function(n){if(!1===n.isActive)throw new Error("Template is already disabled");return Promise.resolve(r.estGasDisableTokenTemplate(e,t)).then(function(n){var o=r.factory721.methods.disableTokenTemplate(t),i=o.send;return Promise.resolve(D(r.web3,r.config)).then(function(t){return Promise.resolve(i.call(o,{from:e,gas:n+1,gasPrice:t}))})})})})})}catch(e){return Promise.reject(e)}},t.estGasReactivateTokenTemplate=function(e,t){try{var r,n=this,o=n.GASLIMIT_DEFAULT,i=Me(function(){return Promise.resolve(n.factory721.methods.reactivateTokenTemplate(t).estimateGas({from:e},function(e,t){return e?o:t})).then(function(e){r=e})},function(){r=o});return Promise.resolve(i&&i.then?i.then(function(){return r}):r)}catch(e){return Promise.reject(e)}},t.reactivateTokenTemplate=function(e,t){try{var r=this;return Promise.resolve(r.getOwner()).then(function(n){if(n!==e)throw new Error("Caller is not Factory Owner");return Promise.resolve(r.getCurrentTokenTemplateCount()).then(function(n){if(t>n)throw new Error("Template index doesnt exist");if(0===t)throw new Error("Template index cannot be ZERO");return Promise.resolve(r.getTokenTemplate(t)).then(function(n){if(!0===n.isActive)throw new Error("Template is already active");return Promise.resolve(r.estGasReactivateTokenTemplate(e,t)).then(function(n){var o=r.factory721.methods.reactivateTokenTemplate(t),i=o.send;return Promise.resolve(D(r.web3,r.config)).then(function(t){return Promise.resolve(i.call(o,{from:e,gas:n+1,gasPrice:t}))})})})})})}catch(e){return Promise.reject(e)}},t.estGasStartMultipleTokenOrder=function(e,t){try{var r,n=this,o=n.GASLIMIT_DEFAULT,i=Me(function(){return Promise.resolve(n.factory721.methods.startMultipleTokenOrder(t).estimateGas({from:e},function(e,t){return e?o:t})).then(function(e){r=e})},function(){r=o});return Promise.resolve(i&&i.then?i.then(function(){return r}):r)}catch(e){return Promise.reject(e)}},t.startMultipleTokenOrder=function(e,t){try{var r=this;if(t.length>50)throw new Error("Too many orders");return Promise.resolve(r.estGasStartMultipleTokenOrder(e,t)).then(function(n){var o=r.factory721.methods.startMultipleTokenOrder(t),i=o.send;return Promise.resolve(D(r.web3,r.config)).then(function(t){return Promise.resolve(i.call(o,{from:e,gas:n+1,gasPrice:t}))})})}catch(e){return Promise.reject(e)}},t.estGasCreateNftWithErc20=function(e,t,r){try{var n,o=this,i=o.GASLIMIT_DEFAULT,s=Me(function(){var s=W(r);return Promise.resolve(o.factory721.methods.createNftWithErc20(t,s).estimateGas({from:e},function(e,t){return e?i:t})).then(function(e){n=e})},function(){n=i});return Promise.resolve(s&&s.then?s.then(function(){return n}):n)}catch(e){return Promise.reject(e)}},t.createNftWithErc20=function(e,t,r){try{var n=this,o=W(r);return Promise.resolve(n.estGasCreateNftWithErc20(e,t,r)).then(function(r){var i=n.factory721.methods.createNftWithErc20(t,o),s=i.send;return Promise.resolve(D(n.web3,n.config)).then(function(t){return Promise.resolve(s.call(i,{from:e,gas:r+1,gasPrice:t}))})})}catch(e){return Promise.reject(e)}},t.estGasCreateNftErc20WithPool=function(e,t,r,n){try{var o,i=this,s=i.GASLIMIT_DEFAULT,a=Me(function(){var a=W(r);return Promise.resolve(U(i.web3,n)).then(function(r){return Promise.resolve(i.factory721.methods.createNftWithErc20WithPool(t,a,r).estimateGas({from:e},function(e,t){return e?s:t})).then(function(e){o=e})})},function(){o=s});return Promise.resolve(a&&a.then?a.then(function(){return o}):o)}catch(e){return Promise.reject(e)}},t.createNftErc20WithPool=function(e,t,r,n){try{var o=this;return Promise.resolve(o.estGasCreateNftErc20WithPool(e,t,r,n)).then(function(i){var s=W(r);return Promise.resolve(U(o.web3,n)).then(function(r){var n=o.factory721.methods.createNftWithErc20WithPool(t,s,r),a=n.send;return Promise.resolve(D(o.web3,o.config)).then(function(t){return Promise.resolve(a.call(n,{from:e,gas:i+1,gasPrice:t}))})})})}catch(e){return Promise.reject(e)}},t.estGasCreateNftErc20WithFixedRate=function(e,t,r,n){try{var o,i=this,s=i.GASLIMIT_DEFAULT,a=W(r);return Promise.resolve(B(n)).then(function(r){var n=Me(function(){return Promise.resolve(i.factory721.methods.createNftWithErc20WithFixedRate(t,a,r).estimateGas({from:e},function(e,t){return e?s:t})).then(function(e){o=e})},function(){o=s});return n&&n.then?n.then(function(){return o}):o})}catch(e){return Promise.reject(e)}},t.createNftErc20WithFixedRate=function(e,t,r,n){try{var o=this,i=W(r),s=B(n);return Promise.resolve(o.estGasCreateNftErc20WithFixedRate(e,t,r,n)).then(function(r){var n=o.factory721.methods.createNftWithErc20WithFixedRate(t,i,s),a=n.send;return Promise.resolve(D(o.web3,o.config)).then(function(t){return Promise.resolve(a.call(n,{from:e,gas:r+1,gasPrice:t}))})})}catch(e){return Promise.reject(e)}},t.estGasCreateNftErc20WithDispenser=function(e,t,r,n){try{var o,i=this,s=i.GASLIMIT_DEFAULT,a=W(r),c=Me(function(){return Promise.resolve(i.factory721.methods.createNftWithErc20WithDispenser(t,a,n).estimateGas({from:e},function(e,t){return e?s:t})).then(function(e){o=e})},function(e){o=s,I.error("Failed to estimate gas for createNftErc20WithDispenser",e)});return Promise.resolve(c&&c.then?c.then(function(){return o}):o)}catch(e){return Promise.reject(e)}},t.createNftErc20WithDispenser=function(e,t,r,n){try{var o=this,i=W(r);return n.maxBalance=P.default.utils.toWei(n.maxBalance),n.maxTokens=P.default.utils.toWei(n.maxTokens),Promise.resolve(o.estGasCreateNftErc20WithDispenser(e,t,r,n)).then(function(r){var s=o.factory721.methods.createNftWithErc20WithDispenser(t,i,n),a=s.send;return Promise.resolve(D(o.web3,o.config)).then(function(t){return Promise.resolve(a.call(s,{from:e,gas:r+1,gasPrice:t}))})})}catch(e){return Promise.reject(e)}},e}(),Le=function(e){return function(e,t){void 0===e&&(e="");var r=function(e,t,r){if("string"!=typeof e)throw I.debug("Not input string:"),I.debug(e),new Error("[zeroXTransformer] Expected string, input type: "+typeof e);var n=e.match(/^(?:0x)*([a-f0-9]+)$/i);return n?{valid:!0,output:n[1]}:(I.warn("[zeroXTransformer] Input transformation failed."),{valid:!1,output:e})}(e);return""+r.output}(e)};function Oe(e,t){try{var r=e()}catch(e){return t(e)}return r&&r.then?r.then(void 0,t):r}var Ue=/*#__PURE__*/function(){function e(){}var t=e.prototype;return t.getEndpoints=function(e){try{return Promise.resolve(Oe(function(){return Promise.resolve(q(e)).then(function(e){return Promise.resolve(e.json())})},function(e){return I.error("Finding the service endpoints failed:",e),null}))}catch(e){return Promise.reject(e)}},t.getEndpointURL=function(e,t){return e?e.find(function(e){return e.serviceName===t}):null},t.getServiceEndpoints=function(e,t){try{var r=[];for(var n in t.serviceEndpoints)r.push({serviceName:n,method:t.serviceEndpoints[n][0],urlPath:e+t.serviceEndpoints[n][1]});return Promise.resolve(r)}catch(e){return Promise.reject(e)}},t.getNonce=function(e,t,r,n,o){try{var i=function(){function i(){var e=s.getEndpointURL(o,"nonce")?s.getEndpointURL(o,"nonce").urlPath:null;return e?Oe(function(){return Promise.resolve(p.default(e+"?userAddress="+t,{method:"GET",headers:{"Content-Type":"application/json"},signal:r})).then(function(e){return Promise.resolve(e.json()).then(function(e){return e.nonce.toString()})})},function(e){throw I.error(e),new Error("HTTP request failed")}):null}var a=function(){if(!o)return Promise.resolve(s.getServiceEndpoints(e,n)).then(function(e){o=e})}();return a&&a.then?a.then(i):i()},s=this,a=function(){if(!n)return Promise.resolve(s.getEndpoints(e)).then(function(e){n=e})}();return Promise.resolve(a&&a.then?a.then(i):i())}catch(e){return Promise.reject(e)}},t.createSignature=function(e,t,r){try{return Promise.resolve(ee(e,Le(r),t))}catch(e){return Promise.reject(e)}},t.createHashSignature=function(e,t,r){try{return Promise.resolve(Y(e,r,t))}catch(e){return Promise.reject(e)}},t.encrypt=function(e,t,r){try{var n=this;return Promise.resolve(n.getEndpoints(t)).then(function(o){return Promise.resolve(n.getServiceEndpoints(t,o)).then(function(t){var o=n.getEndpointURL(t,"encrypt")?n.getEndpointURL(t,"encrypt").urlPath:null;return o?Oe(function(){return Promise.resolve(p.default(o,{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/octet-stream"},signal:r})).then(function(e){return Promise.resolve(e.text())})},function(e){throw I.error(e),new Error("HTTP request failed")}):null})})}catch(e){return Promise.reject(e)}},t.checkDidFiles=function(e,t,r,n){try{var o=this;return Promise.resolve(o.getEndpoints(r)).then(function(i){return Promise.resolve(o.getServiceEndpoints(r,i)).then(function(r){var i={did:e,serviceId:t},s=[],a=o.getEndpointURL(r,"fileinfo")?o.getEndpointURL(r,"fileinfo").urlPath:null;return a?Oe(function(){return Promise.resolve(p.default(a,{method:"POST",body:JSON.stringify(i),headers:{"Content-Type":"application/json"},signal:n})).then(function(e){return Promise.resolve(e.json()).then(function(e){for(var t,r=J(e);!(t=r()).done;)s.push(t.value);return s})})},function(){return null}):null})})}catch(e){return Promise.reject(e)}},t.checkFileUrl=function(e,t,r){try{var n=this;return Promise.resolve(n.getEndpoints(t)).then(function(o){return Promise.resolve(n.getServiceEndpoints(t,o)).then(function(t){var o={url:e,type:"url"},i=[],s=n.getEndpointURL(t,"fileinfo")?n.getEndpointURL(t,"fileinfo").urlPath:null;return s?Oe(function(){return Promise.resolve(p.default(s,{method:"POST",body:JSON.stringify(o),headers:{"Content-Type":"application/json"},signal:r})).then(function(e){return Promise.resolve(e.json()).then(function(e){for(var t,r=J(e);!(t=r()).done;)i.push(t.value);return i})})},function(){return null}):null})})}catch(e){return Promise.reject(e)}},t.getComputeEnvironments=function(e,t){try{var r=this;return Promise.resolve(r.getEndpoints(e)).then(function(n){return Promise.resolve(r.getServiceEndpoints(e,n)).then(function(e){var n,o=null==(n=r.getEndpointURL(e,"computeEnvironments"))?void 0:n.urlPath;return o?Oe(function(){return Promise.resolve(p.default(o,{method:"GET",headers:{"Content-Type":"application/json"},signal:t})).then(function(e){return Promise.resolve(e.json())})},function(e){return I.error(e.message),null}):null})})}catch(e){return Promise.reject(e)}},t.initialize=function(e,t,r,n,o,i,s,a,c){try{var u=this;return Promise.resolve(u.getEndpoints(o)).then(function(l){return Promise.resolve(u.getServiceEndpoints(o,l)).then(function(o){var l=u.getEndpointURL(o,"initialize")?u.getEndpointURL(o,"initialize").urlPath:null;return l?(l+="?documentId="+e,l+="&serviceId="+t,l+="&fileIndex="+r,l+="&consumerAddress="+n,s&&(l+="&userdata="+encodeURI(JSON.stringify(s))),a&&(l+="&environment="+encodeURI(a)),c&&(l+="&validUntil="+c),Oe(function(){return Promise.resolve(p.default(l,{method:"GET",headers:{"Content-Type":"application/json"},signal:i})).then(function(e){return Promise.resolve(e.json())})},function(e){throw I.error(e),new Error("Asset URL not found or not available.")})):null})})}catch(e){return Promise.reject(e)}},t.getDownloadUrl=function(e,t,r,n,o,i,s,a){try{var c=this;return Promise.resolve(c.getEndpoints(i)).then(function(u){return Promise.resolve(c.getServiceEndpoints(i,u)).then(function(i){var u=c.getEndpointURL(i,"download")?c.getEndpointURL(i,"download").urlPath:null;if(!u)return null;var l=Date.now();return Promise.resolve(c.createSignature(s,t,e+l)).then(function(i){var s=u;return s+="?fileIndex="+n,s+="&documentId="+e,s+="&transferTxId="+o,s+="&serviceId="+r,s+="&consumerAddress="+t,s+="&nonce="+l,s+="&signature="+i,a&&(s+="&userdata="+encodeURI(JSON.stringify(a))),s})})})}catch(e){return Promise.reject(e)}},t.computeStart=function(e,t,r,n,o,i,s,a,c){try{var u=this;return Promise.resolve(u.getEndpoints(e)).then(function(l){return Promise.resolve(u.getServiceEndpoints(e,l)).then(function(e){var l=u.getEndpointURL(e,"computeStart")?u.getEndpointURL(e,"computeStart").urlPath:null,f=Date.now(),h=r;return h+=o.documentId,h+=f,Promise.resolve(u.createHashSignature(t,r,h)).then(function(e){var t=Object();return t.consumerAddress=r,t.signature=e,t.nonce=f,t.environment=n,t.dataset=o,t.algorithm=i,t.additionalDatasets&&(t.additionalDatasets=a),c&&(t.output=c),l?Oe(function(){return Promise.resolve(p.default(l,{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"},signal:s})).then(function(e){var r;function n(n){return r?n:(console.error("Compute start failed:",e.status,e.statusText),I.error("Payload was:",t),null)}var o=function(){if(null!=e&&e.ok)return Promise.resolve(e.json()).then(function(e){return r=1,e})}();return o&&o.then?o.then(n):n(o)})},function(e){return I.error("Compute start failed:"),I.error(e),I.error("Payload was:",t),null}):null})})})}catch(e){return Promise.reject(e)}},t.computeStop=function(e,t,r,n,o,i){try{var s=this;return Promise.resolve(s.getEndpoints(n)).then(function(a){return Promise.resolve(s.getServiceEndpoints(n,a)).then(function(c){var u=s.getEndpointURL(c,"computeStop")?s.getEndpointURL(c,"computeStop").urlPath:null;return Promise.resolve(s.getNonce(n,t,i,a,c)).then(function(n){var a=t;return a+=r||"",a+=e&&""+Le(e)||"",a+=n,Promise.resolve(s.createHashSignature(o,t,a)).then(function(n){var o=Object();return o.signature=n,o.documentId=Le(e),o.consumerAddress=t,r&&(o.jobId=r),u?Oe(function(){return Promise.resolve(p.default(u,{method:"PUT",body:JSON.stringify(o),headers:{"Content-Type":"application/json"},signal:i})).then(function(e){var t;function r(r){return t?r:(I.error("Compute stop failed:",e.status,e.statusText),I.error("Payload was:",o),null)}var n=function(){if(null!=e&&e.ok)return Promise.resolve(e.json()).then(function(e){return t=1,e})}();return n&&n.then?n.then(r):r(n)})},function(e){return I.error("Compute stop failed:"),I.error(e),I.error("Payload was:",o),null}):null})})})})}catch(e){return Promise.reject(e)}},t.computeStatus=function(e,t,r,n,o){try{var i=this;return Promise.resolve(i.getEndpoints(e)).then(function(s){return Promise.resolve(i.getServiceEndpoints(e,s)).then(function(e){var s=i.getEndpointURL(e,"computeStatus")?i.getEndpointURL(e,"computeStatus").urlPath:null,a="?consumerAddress="+t;return a+=n&&"&documentId="+Le(n)||"",a+=r&&"&jobId="+r||"",s?Oe(function(){return Promise.resolve(p.default(s+a,{method:"GET",headers:{"Content-Type":"application/json"},signal:o})).then(function(e){var t;function r(r){return t?r:(I.error("Get compute status failed:",e.status,e.statusText),null)}var n=function(){if(null!=e&&e.ok)return Promise.resolve(e.json()).then(function(e){return t=1,e})}();return n&&n.then?n.then(r):r(n)})},function(e){return I.error("Get compute status failed"),I.error(e),null}):null})})}catch(e){return Promise.reject(e)}},t.getComputeResultUrl=function(e,t,r,n,o){try{var i=this;return Promise.resolve(i.getEndpoints(e)).then(function(s){return console.log("computeResult providerEndpoints: ",s),Promise.resolve(i.getServiceEndpoints(e,s)).then(function(e){console.log("computeResult serviceEndpoints: ",e);var s=i.getEndpointURL(e,"computeResult")?i.getEndpointURL(e,"computeResult").urlPath:null;console.log("computeResult computeResultUrl: ",s);var a=Date.now(),c=r;return c+=n,c+=o.toString(),c+=a,Promise.resolve(i.createHashSignature(t,r,c)).then(function(e){var t=s;return t+="?consumerAddress="+r,t+="&jobId="+n,t+="&index="+o.toString(),t+="&nonce="+a,t+=e&&"&signature="+e||"",console.log("computeResult resultUrl: ",t),t||null})})})}catch(e){return Promise.reject(e)}},t.computeDelete=function(e,t,r,n,o,i){try{var s=this;return Promise.resolve(s.getEndpoints(n)).then(function(a){return Promise.resolve(s.getServiceEndpoints(n,a)).then(function(c){var u=s.getEndpointURL(c,"computeDelete")?s.getEndpointURL(c,"computeDelete").urlPath:null;return Promise.resolve(s.getNonce(n,t,i,a,c)).then(function(n){var a=t;return a+=r||"",a+=e&&""+Le(e)||"",a+=n,Promise.resolve(s.createHashSignature(o,t,a)).then(function(n){var o=Object();return o.documentId=Le(e),o.consumerAddress=t,o.jobId=r,n&&(o.signature=n),u?Oe(function(){return Promise.resolve(p.default(u,{method:"DELETE",body:JSON.stringify(o),headers:{"Content-Type":"application/json"},signal:i})).then(function(e){var t;function r(r){return t?r:(I.error("Delete compute job failed:",e.status,e.statusText),I.error("Payload was:",o),null)}var n=function(){if(null!=e&&e.ok)return Promise.resolve(e.json()).then(function(e){return t=1,e})}();return n&&n.then?n.then(r):r(n)})},function(e){return I.error("Delete compute job failed:"),I.error(e),I.error("Payload was:",o),null}):null})})})})}catch(e){return Promise.reject(e)}},t.isValidProvider=function(e,t){try{return Promise.resolve(Oe(function(){return Promise.resolve(p.default(e,{method:"GET",headers:{"Content-Type":"application/json"},signal:t})).then(function(e){var t,r=function(){if(null!=e&&e.ok)return Promise.resolve(e.json()).then(function(e){if(e&&e.providerAddress)return t=!0})}();return r&&r.then?r.then(function(e){return!!t&&e}):!!t&&r})},function(e){return I.error("Error validating provider: "+e.message),!1}))}catch(e){return Promise.reject(e)}},e}(),De=new Ue;e.Aquarius=de,e.Config=function(){this.nodeUri=void 0,this.providerAddress=void 0,this.metadataCacheUri=void 0,this.providerUri=void 0,this.web3Provider=void 0,this.oceanTokenAddress=void 0,this.erc721FactoryAddress=void 0,this.erc721FFactoryABI=void 0,this.datatokensABI=void 0,this.poolTemplateAddress=void 0,this.poolFactoryABI=void 0,this.poolABI=void 0,this.fixedRateExchangeAddress=void 0,this.fixedRateExchangeAddressABI=void 0,this.dispenserAddress=void 0,this.dispenserABI=void 0,this.opfCommunityFeeCollector=void 0,this.sideStakingAddress=void 0,this.startBlock=void 0,this.verbose=void 0,this.authMessage=void 0,this.authTokenExpiration=void 0,this.parityUri=void 0,this.threshold=void 0,this.chainId=void 0,this.network=void 0,this.subgraphUri=void 0,this.explorerUri=void 0,this.oceanTokenSymbol=void 0,this.transactionBlockTimeout=void 0,this.transactionConfirmationBlocks=void 0,this.transactionPollingTimeout=void 0,this.gasFeeMultiplier=void 0},e.ConfigHelper=X,e.Datatoken=Se,e.Dispenser=Ce,e.FixedRateExchange=Fe,e.GASLIMIT_DEFAULT=K,e.Logger=j,e.LoggerInstance=I,e.Nft=je,e.NftFactory=xe,e.Pool=Ae,e.Provider=Ue,e.ProviderInstance=De,e.ZERO_ADDRESS=Q,e.allowance=re,e.amountToUnits=L,e.approve=function(e,t,r,n,o,i){void 0===i&&(i=!1);try{var s,a=function(i){if(s)return i;var a=null;return Promise.resolve(L(e,r,o)).then(function(o){return Promise.resolve(ne(e,t,r,n,o,c)).then(function(r){var i=te(function(){var i=c.methods.approve(n,o),s=i.send;return Promise.resolve(D(e,null)).then(function(e){return Promise.resolve(s.call(i,{from:t,gas:r+1,gasPrice:e})).then(function(e){a=e})})},function(e){I.error("ERRPR: Failed to approve spender to spend tokens : "+e.message)});return i&&i.then?i.then(function(){return a}):a})})},c=new e.eth.Contract(G,r),u=function(){if(!i)return Promise.resolve(re(e,r,t,n)).then(function(e){if(new y.default(e).greaterThanOrEqualTo(new y.default(o)))return s=1,e})}();return Promise.resolve(u&&u.then?u.then(a):a(u))}catch(e){return Promise.reject(e)}},e.balance=function(e,t,r){try{var n=new e.eth.Contract(G,t);return Promise.resolve(n.methods.balanceOf(r).call()).then(function(r){return Promise.resolve(O(e,t,r))})}catch(e){return Promise.reject(e)}},e.calcMaxExactIn=le,e.calcMaxExactOut=ue,e.configHelperNetworks=V,e.downloadFile=function(e,t){try{return Promise.resolve(p.default(e)).then(function(r){if(!r.ok)throw new Error("Response error.");var n;try{n=r.headers.get("content-disposition").match(/attachment;filename=(.+)/)[1]}catch(r){try{n=e.split("/").pop()}catch(e){n="file"+t}}return Promise.resolve(r.arrayBuffer()).then(function(e){return{data:e,filename:n}})})}catch(e){return Promise.reject(e)}},e.downloadFileBrowser=function(e){try{var t=document.createElement("a");return t.download="",t.href=e,t.click(),Promise.resolve()}catch(e){return Promise.reject(e)}},e.estApprove=ne,e.fetchData=function(e,t){try{return Promise.resolve(p.default(e,t)).then(function(r){var n=function(){if(!r.ok){I.error("Error requesting ["+t.method+"] "+e);var n=I.error;return Promise.resolve(r.text()).then(function(e){throw n.call(I,"Response message: \n"+e),r})}}();return n&&n.then?n.then(function(e){return r}):r})}catch(e){return Promise.reject(e)}},e.generateDid=function(e,t){return e=P.default.utils.toChecksumAddress(e),"did:op:"+b.default(e+t.toString(10)).toString()},e.generateDtName=M,e.getData=q,e.getErcCreationParams=W,e.getFairGasPrice=D,e.getFreCreationParams=B,e.getFreOrderParams=_,e.getHash=function(e){try{return b.default(e).toString()}catch(e){I.error("getHash error: ",e.message)}},e.getMaxAddLiquidity=se,e.getMaxRemoveLiquidity=ie,e.getMaxSwapExactIn=ae,e.getMaxSwapExactOut=ce,e.getPoolCreationParams=U,e.postData=function(e,t){return function(e,t,r){try{return Promise.resolve(p.default(e,null!=t?{method:"POST",body:t,headers:{"Content-type":"application/json"}}:{method:"POST"}))}catch(e){return Promise.reject(e)}}(e,t)},e.setContractDefaults=N,e.signHash=function(e,t,r){try{return Promise.resolve(e.eth.sign(t,r)).then(function(e){var t="0x"+(e=e.substr(2)).slice(0,64),r="0x"+e.slice(64,128),n="0x"+e.slice(128,130);return"0x00"===n&&(n="0x1b"),"0x01"===n&&(n="0x1c"),{v:n,r:t,s:r}})}catch(e){return Promise.reject(e)}},e.signText=ee,e.signWithHash=Y,e.sleep=oe,e.unitsToAmount=O});
//# sourceMappingURL=lib.umd.js.map
